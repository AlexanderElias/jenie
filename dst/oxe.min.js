/*
	Name: oxe
	Version: 4.0.0
	License: MPL-2.0
	Author: Alexander Elias
	Email: alex.steven.elis@gmail.com
	This Source Code Form is subject to the terms of the Mozilla Public
	License, v. 2.0. If a copy of the MPL was not distributed with this
	file, You can obtain one at http://mozilla.org/MPL/2.0/.
*/
var _createClass=function(){function e(e,t){for(var n,r=0;r<t.length;r++)n=t[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _continueIgnored(e){if(e&&e.then)return e.then(_empty)}function _for(e,t,n){function r(i){s=i;do{if(t&&(d=t(),d&&d.then&&!_isSettledPact(d)))return void d.then(l).then(void 0,p);if(o=e(),!o||_isSettledPact(o)&&!o.__value)return void _settle(c,1,s);if(o.then)return void o.then(a).then(void 0,p);s=n(),_isSettledPact(s)&&(s=s.__value)}while(!s||!s.then);s.then(r).then(void 0,p)}function a(e){e?(s=n(),s&&s.then?s.then(r).then(void 0,p):r(s)):_settle(c,1,s)}function l(){(o=e())?o.then?o.then(a).then(void 0,p):a(o):_settle(c,1,s)}for(var i,o;;){if(o=e(),_isSettledPact(o)&&(o=o.__value),!o)return s;if(o.then){i=0;break}var s=n();if(s&&s.then)if(_isSettledPact(s))s=s.__state;else{i=1;break}if(t){var d=t();if(d&&d.then&&!_isSettledPact(d)){i=2;break}}}var c=new _Pact,p=_settle.bind(null,c,2);return(0===i?o.then(a):1===i?s.then(r):d.then(l)).then(void 0,p),c}function _isSettledPact(e){return e instanceof _Pact&&1===e.__state}var _Pact=function(){function e(){}return e.prototype.then=function(t,n){var r=this.__state;if(r){var a=1==r?t:n;if(a){var l=new e;try{_settle(l,1,a(this.__value))}catch(t){_settle(l,2,t)}return l}return this}var i=new e;return this.__observer=function(e){try{var r=e.__value;1==e.__state?_settle(i,1,t?t(r):r):n?_settle(i,1,n(r)):_settle(i,2,r)}catch(t){_settle(i,2,t)}},i},e}();function _settle(e,t,n){if(!e.__state){if(n instanceof _Pact)if(n.__state)1===t&&(t=n.__state),n=n.__value;else return void(n.__observer=_settle.bind(null,e,t));if(n&&n.then)return void n.then(_settle.bind(null,e,t),_settle.bind(null,e,2));e.__state=t,e.__value=n;var r=e.__observer;r&&r(e)}}function _awaitIgnored(e,t){if(!t)return Promise.resolve(e).then(_empty)}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _invoke(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function _invokeIgnored(e){var t=e();if(t&&t.then)return t.then(_empty)}function _empty(){}function _await(e,t,n){return n?t?t(e):e:(e=Promise.resolve(e),t?e.then(t):e)}var _async=function(){try{if(isNaN.apply(null,{}))return function(e){return function(){try{return Promise.resolve(e.apply(this,arguments))}catch(t){return Promise.reject(t)}}}}catch(t){}return function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(t){return Promise.reject(t)}}}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Oxe",t):e.Oxe=t()})(this,function(){"use strict";function e(e){return{write:function(){e.element.disabled=!1}}}function t(e){return{write:function(){e.element.disabled=!0}}}function n(e){var t;return{read:function(){if(t=O.get(e.keys),t=k.piper(e,t),t===e.element.disabled)return!1},write:function(){e.element.disabled=t}}}function r(e){var t;return{read:function(){if(t=O.get(e.keys),t=k.piper(e,t),!t===e.element.disabled)return!1},write:function(){e.element.disabled=!t}}}function a(e){e.target.hasAttribute("o-value")&&Promise.resolve().then(function(){return c(e.target,"value")}).catch(console.error)}function l(e){"checkbox"!==e.target.type&&"radio"!==e.target.type&&"option"!==e.target.type&&"SELECT"!==e.target.nodeName&&e.target.hasAttribute("o-value")&&Promise.resolve().then(function(){return c(e.target,"value")}).catch(console.error)}function i(e){if(!(0!==e.button||e.defaultPrevented||"INPUT"===e.target.nodeName||"BUTTON"===e.target.nodeName||"SELECT"===e.target.nodeName||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)){var t=e.path?e.path[0]:e.target,n=t.parentNode;if(q.contain){for(;n&&"O-ROUTER"!==n.nodeName;)n=n.parentNode;if("O-ROUTER"!==n.nodeName)return}for(;t&&"A"!==t.nodeName;)t=t.parentNode;!t||"A"!==t.nodeName||t.hasAttribute("download")||t.hasAttribute("external")||t.hasAttribute("o-external")||0===t.href.indexOf("tel:")||0===t.href.indexOf("ftp:")||0===t.href.indexOf("file:")||0===t.href.indexOf("mailto:")||0!==t.href.indexOf(window.location.origin)||q.external&&(q.external.constructor===RegExp&&q.external.test(t.href)||q.external.constructor===Function&&q.external(t.href)||q.external.constructor===String&&q.external===t.href)||(e.preventDefault(),q.location.href!==t.href&&Promise.resolve().then(function(){return q.route(t.href)}).catch(console.error))}}function o(e){var t=e&&e.state?e.state.path:window.location.href;Promise.resolve().then(function(){return q.route(t,{mode:"replace"})}).catch(console.error)}var s=_async(function(e){var t=e.target,n=k.elements.get(t).get("submit"),r=O.get(n.scope);y.formReset(t,r)}),d=_async(function(e){var t,n=e.target,r=k.elements.get(n).get("submit"),t=g.get(r.keys),a=O.get(r.scope),l=y.formData(n,a);return _await(t.call(r.container,l,e),function(e){return _invoke(function(){if("object"===("undefined"==typeof e?"undefined":_typeof(e))){var r=n.getAttribute("o-action");t=n.getAttribute("o-method");var a=n.getAttribute("o-enctype");return e.url=e.url||r,e.method=e.method||t,e.contentType=e.contentType||a,_await(w.fetch(e),function(t){return _invokeIgnored(function(){if(e.handler)return _awaitIgnored(e.handler(t))})})}},function(){(n.hasAttribute("o-reset")||"object"===("undefined"==typeof e?"undefined":_typeof(e))&&e.reset)&&n.reset()})})}),c=_async(function(e,t){if(!e)throw new Error("Oxe - requires element argument");if(!t)throw new Error("Oxe - requires attribute argument");var n=k.elements.get(e).get(t);m.batch({read:function(){var e=n.element.type,t=n.element.nodeName,r=void 0;if("SELECT"===t){var a=n.element.options,l=n.element.multiple,i=!1;r=l?[]:"";for(var o,s=0,d=a.length;s<d;s++)if(o=a[s],o.selected)if(i=!0,l)r.push(o.value);else{r=o.value;break}!a.length||l||i||(r=a[0].value)}else if("radio"===e)for(var c,p="input[type=\"radio\"][o-value=\""+n.value+"\"]",u=n.container.querySelectorAll(p),m=0,h=u.length;m<h;m++)c=u[m],n.element===c&&(r=m);else if("file"===e){var y=n.element.files;r=r||[];for(var f,g=0,b=y.length;g<b;g++)f=y[g],r.push(f)}else r="checkbox"===e?n.element.checked:n.element.value;if(void 0!==r){var v=O.get(n.keys);if(r&&"object"===("undefined"==typeof r?"undefined":_typeof(r))&&r.constructor===v.constructor){for(var k in r)if(r[k]!==v[k]){O.set(n.keys,r);break}}else v!==r&&O.set(n.keys,r)}}})}),p={splice:function(){var e=this,t=arguments[0],n=arguments[1],r=2<arguments.length?arguments.length-2:0;if("number"!=typeof t||"number"!=typeof n)return[];0>t?(t=e.length+t,t=0<t?t:0):t=t<e.length?t:e.length,0>n?n=0:n>e.length-t&&(n=e.length-t);var a=e.$meta.length,l=void 0,i=void 0,o=void 0,s=void 0,d=2,c=arguments.length-d,u=e.slice(t,n);s=a-1-t;var m=[];if(0<s)for(i=t;s--;)l=i++,o=c&&d<c?arguments[d++]:e.$meta[i],e.$meta[l]=p.create(o,e.$meta.listener,e.$meta.path+l),m.push(e.$meta.listener.bind(null,e.$meta[l],e.$meta.path+l,l));if(0<r)for(m.push(e.$meta.listener.bind(null,e.length+r,e.$meta.path.slice(0,-1),"length"));r--;)l=e.length,e.$meta[l]=p.create(arguments[d++],e.$meta.listener,e.$meta.path+l),p.defineProperty(e,l),m.push(e.$meta.listener.bind(null,e.$meta[l],e.$meta.path+l,l));if(0<n)for(m.push(e.$meta.listener.bind(null,e.length-n,e.$meta.path.slice(0,-1),"length"));n--;)e.$meta.length--,e.length--,l=e.length,m.push(e.$meta.listener.bind(null,void 0,e.$meta.path+l,l));return m.reduce(function(e,t){return e.then(t)},Promise.resolve()).catch(console.error),u},arrayProperties:function(){var e=this;return{push:{value:function(){if(!arguments.length)return this.length;for(var t=0,n=arguments.length;t<n;t++)e.splice.call(this,this.length,0,arguments[t]);return this.length}},unshift:{value:function(){if(!arguments.length)return this.length;for(var t=0,n=arguments.length;t<n;t++)e.splice.call(this,0,0,arguments[t]);return this.length}},pop:{value:function(){return this.length?e.splice.call(this,this.length-1,1):void 0}},shift:{value:function(){return this.length?e.splice.call(this,0,1):void 0}},splice:{value:e.splice}}},objectProperties:function(){var e=this;return{$get:{value:function(e){return this.$meta[e]}},$set:{value:function(t,n){n!==this.$meta[t]&&(e.defineProperty(this,t),this.$meta[t]=e.create(n,this.$meta.listener,this.$meta.path+t),this.$meta.listener(this[t],this.$meta.path+t,t,this))}},$remove:{value:function(t){if(t in this){if(this.constructor===Array)return e.splice.call(this,t,1);var n=this[t];return delete this.$meta[t],delete this[t],this.$meta.listener(void 0,this.$meta.path+t,t),n}}}}},property:function(e){var t=this;return{enumerable:!0,configurable:!0,get:function(){return this.$meta[e]},set:function(n){n!==this.$meta[e]&&(this.$meta[e]=t.create(n,this.$meta.listener,this.$meta.path+e),this.$meta.listener(this[e],this.$meta.path+e,e,this))}}},defineProperty:function(e,t){return Object.defineProperty(e,t,this.property(t))},create:function(e,t,n){var r=this;if(!e||e.constructor!==Object&&e.constructor!==Array)return e;n=n?n+".":"";var a=void 0,l=void 0,i=e.constructor,o=e.constructor(),s=e.constructor();if(s.$meta={value:e.constructor()},s.$meta.value.path=n,s.$meta.value.listener=t,i===Array){for(a=0,l=e.length;a<l;a++)s.$meta.value[a]=r.create(e[a],t,n+a),s[a]=r.property(a);var d=r.arrayProperties();for(a in d)s[a]=d[a]}if(i===Object)for(a in e)s.$meta.value[a]=r.create(e[a],t,n+a),s[a]=r.property(a);var c=r.objectProperties();for(a in c)s[a]=c[a];return Object.defineProperties(o,s)}},u=function(){function e(){_classCallCheck(this,e),this.reads=[],this.writes=[],this.time=1e3/30,this.pending=!1}return _createClass(e,[{key:"setup",value:function(e){e=e||{},this.time=e.time||this.time}},{key:"tick",value:function(e){return window.requestAnimationFrame(e)}},{key:"schedule",value:function(){this.pending||(this.pending=!0,this.tick(this.flush.bind(this,null)))}},{key:"flush",value:function(e){e=e||performance.now();for(var t;t=this.reads.shift();)if(t(),performance.now()-e>this.time)return void this.tick(this.flush.bind(this,null));for(;t=this.writes.shift();)if(t(),performance.now()-e>this.time)return void this.tick(this.flush.bind(this,null));this.reads.length||this.writes.length?performance.now()-e>this.time?this.tick(this.flush.bind(this,null)):this.flush(e):this.pending=!1}},{key:"remove",value:function(e,t){var n=e.indexOf(t);return!!~n&&!!e.splice(n,1)}},{key:"clear",value:function(e){return this.remove(this.reads,e)||this.remove(this.writes,e)}},{key:"batch",value:function(e){var t=this;if(e.read){var n=function(){var n=void 0,r=void 0;n=e.context?e.read.call(e.context):e.read(),e.write&&!1!==n&&(r=e.context?e.write.bind(e.context):e.write,t.writes.push(r),t.schedule())};t.reads.push(n),t.schedule()}else if(e.write){var r;r=e.context?e.write.bind(e.context,e.shared):e.write,t.writes.push(r),t.schedule()}return e}}]),e}(),m=new u,h={class:function(e){return{write:function(){var t=e.names.slice(1).join("-");e.element.classList.remove(t)}}},css:function(e){return{write:function(){e.element.style.cssText=""}}},default:function(e){var t;t=e.type in this?this[e.type](e):{read:function(){if(""===e.element[e.type])return!1},write:function(){e.element[e.type]=""}},m.batch(t)},disable:e,disabled:e,each:function(e){return{write:function(){for(var t;t=e.element.lastElementChild;)e.element.removeChild(t)}}},enable:t,enabled:t,hide:function(e){return{write:function(){e.element.hidden=!1}}},html:function(e){return{write:function(){for(var t;t=e.element.lastElementChild;)e.element.removeChild(t)}}},on:function(e){return{write:function(){e.element.removeEventListener(e.names[1],e.cache,!1)}}},read:function(e){return{write:function(){e.element.readOnly=!1}}},required:function(e){return{write:function(){e.element.required=!1}}},show:function(e){return{write:function(){e.element.hidden=!0}}},text:function(e){return{write:function(){e.element.innerText=""}}},value:function(e){return{write:function(){var t,n,r,a,l;if("SELECT"===e.element.nodeName)for(l=e.element.options,t=0,n=l.length;t<n;t++)a=l[t],a.selected=!1;else if("radio"===e.element.type)for(r="input[type=\"radio\"][o-value=\""+e.path+"\"]",l=e.element.parentNode.querySelectorAll(r),(t=0,n=l.length);t<n;t++)a=l[t],a.checked=0===t;else"checkbox"===e.element.type?(e.element.checked=!1,e.element.value=!1):e.element.value=""}}},write:function(e){return{write:function(){e.element.readOnly=!0}}}},y={PREFIX:/data-o-|o-/,ROOT:/^(https?:)?\/?\//,DOT:/\.+/,PIPE:/\s?\|\s?/,PIPES:/\s?,\s?|\s+/,VARIABLE_START:"(^|(\\|+|\\,+|\\s))",VARIABLE_END:"(?:)",binderNames:function(e){return e=e.split(this.PREFIX)[1],e?e.split("-"):[]},binderValues:function(e){return e=e.split(this.PIPE)[0],e?e.split("."):[]},binderPipes:function(e){return e=e.split(this.PIPE)[1],e?e.split(this.PIPES):[]},ensureElement:function(e){e.query=e.query||"",e.scope=e.scope||document.body;var t=e.scope.querySelector(""+e.name+e.query);t||(t=document.createElement(e.name),"afterbegin"===e.position?e.scope.insertBefore(t,e.scope.firstChild):"beforeend"===e.position?e.scope.appendChild(t):e.scope.appendChild(t));for(var n,r=0,a=e.attributes.length;r<a;r++)n=e.attributes[r],t.setAttribute(n.name,n.value);return t},formData:function(e,t){for(var n,r=e.querySelectorAll("[o-value]"),a={},o=0,i=r.length;o<i;o++)if(n=r[o],"OPTION"!==n.nodeName){var l=n.getAttribute("o-value");if(l){var s=this.binderValues(l);a[s[s.length-1]]=this.getByPath(t,s)}}return a},formReset:function(e,t){for(var n,r=e.querySelectorAll("[o-value]"),a=0,i=r.length;a<i;a++)if(n=r[a],"OPTION"!==n.nodeName){var l=n.getAttribute("o-value");if(l){var o=this.binderValues(l);this.setByPath(t,o,"")}}},walker:function(e,t){for(t(e),e=e.firstChild;e;)this.walker(e,t),e=e.nextSibling},replaceEachVariable:function(e,t,n,r){var a=this,o=new RegExp(this.VARIABLE_START+t+this.VARIABLE_END,"g");a.walker(e,function(e){if(3===e.nodeType)(e.nodeValue==="$"+t||"$index"===e.nodeValue)&&(e.nodeValue=r);else if(1===e.nodeType)for(var a,s=0,i=e.attributes.length;s<i;s++)a=e.attributes[s],(0===a.name.indexOf("o-")||0===a.name.indexOf("data-o-"))&&(a.value=a.value.replace(o,"$1"+n+"."+r))})},traverse:function(e,t,n){for(var r,a="string"==typeof t?t.split("."):t,l=a.length-1,o=0;o<l;o++){if(r=a[o],!(r in e))if("function"==typeof n)n(e,r,o,a);else return;e=e[r]}return{data:e,key:a[l]}},setByPath:function(e,t,n){for(var r,a="string"==typeof t?t.split("."):t,l=a.length-1,o=0;o<l;o++)r=a[o],r in e||(isNaN(a[o+1])?e[r]={}:e[r]=[]),e=e[r];return e[a[l]]=n},getByPath:function(e,t){for(var n,r="string"==typeof t?t.split("."):t,a=r.length-1,l=0;l<a;l++){if(n=r[l],!(n in e))return;e=e[n]}return e[r[a]]},joinDot:function(){return Array.prototype.join.call(arguments,".").replace(/\.{2,}/g,".")},ready:function(e){e&&("interactive"!==document.readyState&&"complete"!==document.readyState?document.addEventListener("DOMContentLoaded",function t(){e(),document.removeEventListener("DOMContentLoaded",t)},!0):e())}},f=function(){function e(){_classCallCheck(this,e),this.data={}}return _createClass(e,[{key:"get",value:function(e){return y.getByPath(this.data,e)}},{key:"set",value:function(e,t){return y.setByPath(this.data,e,t)}}]),e}(),g=new f,b={class:function(e){var t,n;return{write:function(){t=O.get(e.keys),t=k.piper(e,t),n=e.names.slice(1).join("-"),e.element.classList.toggle(n,t)}}},css:function(e){var t;return{read:function(){if(t=O.get(e.keys),t=k.piper(e,t),1<e.names.length&&(t=e.names.slice(1).join("-")+": "+t+";"),t===e.element.style.cssText)return!1},write:function(){e.element.style.cssText=t}}},default:function(e){var t;if(e.type in this)t=this[e.type](e);else{var n;t={read:function(){return(n=O.get(e.keys),n=k.piper(e,n),void 0===n||null===n)?(O.set(e.keys,""),!1):("object"===("undefined"==typeof n?"undefined":_typeof(n))?n=JSON.stringify(n):"string"!=typeof n&&(n=n.toString()),n!==e.element[e.type]&&void 0)},write:function(){e.element[e.type]=n}}}t&&m.batch(t)},disable:n,disabled:n,each:function(e){if(e.cache||e.element.children.length){e.fragment||(e.fragment=document.createDocumentFragment()),e.cache||(e.cache=e.element.removeChild(e.element.firstElementChild));var t,n,r,a=this;return{read:function(){if(t=O.get(e.keys),t=k.piper(e,t),!t||"object"!==("undefined"==typeof t?"undefined":_typeof(t)))return!1;var l=t.constructor===Array,i=l?[]:Object.keys(t),o=l?t.length:i.length,s=e.fragment.children.length+e.element.children.length;if(s===o)return!1;if(s>o)r=!0,s--;else if(s<o){var d=document.importNode(e.cache,!0),c=l?s:i[s];if(y.replaceEachVariable(d,e.names[1],e.path,c),k.bind(d,e.container,e.scope),e.fragment.appendChild(d),s++,s===o&&(n=!0),"SELECT"===e.element.nodeName&&e.element.attributes["o-value"]){var p=e.element.attributes["o-value"].name,u=e.element.attributes["o-value"].value,m=k.create({name:p,value:u,scope:e.scope,element:e.element,container:e.container});a.default(m)}}return s<o?(a.default(e),!1):void 0},write:function(){r?e.element.removeChild(e.element.lastElementChild):n&&e.element.appendChild(e.fragment)}}}},enable:r,enabled:r,hide:function(e){var t;return{read:function(){if(t=O.get(e.keys),t=k.piper(e,t),t===e.element.hidden)return!1},write:function(){e.element.hidden=t}}},html:function(e){var t;return{read:function(){return(t=O.get(e.keys),t=k.piper(e,t),void 0===t||null===t)?(O.set(e.keys,""),!1):("object"===("undefined"==typeof t?"undefined":_typeof(t))?t=JSON.stringify(t):"string"!=typeof t&&(t+=""),t!==e.element.innerHTML&&void 0)},write:function(){e.element.innerHTML=t}}},on:function(t){var n;return{write:function(){return n=g.get(t.keys),"function"==typeof n?void(!t.cache&&(t.cache=function(r){for(var e,a=[r],o=0,i=t.pipes.length;o<i;o++){e=t.pipes[o].split("."),e.unshift(t.scope);var l=O.get(e);a.push(l)}Promise.resolve().then(n.bind(t.container).apply(null,a)).catch(console.error)}),t.element.removeEventListener(t.names[1],t.cache),t.element.addEventListener(t.names[1],t.cache)):(console.warn("Oxe - attribute o-on=\""+t.keys.join(".")+"\" invalid type function required"),!1)}}},read:function(e){var t;return{read:function(){if(t=O.get(e.keys),t=k.piper(e,t),t===e.element.readOnly)return!1},write:function(){e.element.readOnly=t}}},required:function(e){var t;return{read:function(){if(t=O.get(e.keys),t=k.piper(e,t),t===e.element.required)return!1},write:function(){e.element.required=t}}},show:function(e){var t;return{read:function(){if(t=O.get(e.keys),t=k.piper(e,t),!t===e.element.hidden)return!1},write:function(){e.element.hidden=!t}}},text:function(e){var t;return{read:function(){return(t=O.get(e.keys),t=k.piper(e,t),void 0===t||null===t)?(O.set(e.keys,""),!1):("object"===("undefined"==typeof t?"undefined":_typeof(t))?t=JSON.stringify(t):"string"!=typeof t&&(t=t.toString()),t!==e.element.innerText&&void 0)},write:function(){e.element.innerText=t}}},value:function(e){var t=this,n=e.element.type,r=e.element.nodeName,a=void 0,l=void 0;if("SELECT"===r){var o;return{read:function(){if(a=O.get(e.keys),a=k.piper(e,a),o=e.element.options,l=e.element.multiple,l&&a.constructor!==Array)throw new Error("Oxe - invalid multiple select value type "+e.keys.join(".")+" array required")},write:function(){for(var t,n=0,r=!1,s=0,i=o.length;s<i;s++)t=o[s],t.value===a?(r=!0,t.setAttribute("selected","")):t.hasAttribute("selected")?(n=s,t.removeAttribute("selected")):t.removeAttribute("selected");o.length&&!r&&(o[n].setAttribute("selected",""),a!==(o[n].value||"")&&O.set(e.keys,o[n].value||""))}}}if("radio"===n){var s;return{read:function(){return a=O.get(e.keys),void 0===a?(O.set(e.keys,0),!1):void(s=e.container.querySelectorAll("input[type=\"radio\"][o-value=\""+e.value+"\"]"))},write:function(){for(var t,n=!1,r=0,i=s.length;r<i;r++)t=s[r],r===a?(n=!0,t.checked=!0):t.checked=!1;n||(s[0].checked=!0,O.set(e.keys,0))}}}return"file"===n?{read:function(){return a=O.get(e.keys),void 0===a?(O.set(e.keys,[]),!1):a&&a.constructor===Array?void 0:(console.warn("Oxe - file attribute invalid type"),!1)},write:function(){for(var t=0,n=a.length;t<n;t++)a[t]!==e.element.files[t]&&(a[t]?e.element.files[t]=a[t]:console.warn("Oxe - file remove not implemented"))}}:"checkbox"===n?{read:function(){return a=O.get(e.keys),"boolean"==typeof a?a!==e.element.checked&&void 0:(O.set(e.keys,!1),!1)},write:function(){e.element.checked=a}}:{read:function(){if("OPTION"===r&&e.element.selected){var n=e.element.parentElement,l=k.elements.get(n).get("value");t.default(l)}return a=O.get(e.keys),void 0===a||null===a?(O.set(e.keys,""),!1):a!==e.element.value&&void 0},write:function(){e.element.value=a}}},write:function(e){var t;return{read:function(){if(t=O.get(e.keys),t=k.piper(e,t),!t===e.element.readOnly)return!1},write:function(){e.element.readOnly=!t}}}},v=function(){function e(){_classCallCheck(this,e),this.data={},this.elements=new Map}return _createClass(e,[{key:"create",value:function(e){var t={};if(void 0===e.name)throw new Error("Oxe.binder.create - missing name");if(void 0===e.value)throw new Error("Oxe.binder.create - missing value");if(void 0===e.scope)throw new Error("Oxe.binder.create - missing scope");if(void 0===e.element)throw new Error("Oxe.binder.create - missing element");if(void 0===e.container)throw new Error("Oxe.binder.create - missing container");return t.name=e.name,t.value=e.value,t.scope=e.scope,t.element=e.element,t.container=e.container,t.names=e.names||y.binderNames(e.name),t.pipes=e.pipes||y.binderPipes(e.value),t.values=e.values||y.binderValues(e.value),t.context={},t.path=t.values.join("."),t.type=t.type||t.names[0],t.keys=[t.scope].concat(t.values),t}},{key:"get",value:function(e){var t;if("string"==typeof e?(t={},t.scope=e.split(".").slice(0,1).join("."),t.path=e.split(".").slice(1).join(".")):t=e,!(t.scope in this.data))return null;if(!(t.path in this.data[t.scope]))return null;for(var n,r=this.data[t.scope][t.path],a=0,i=r.length;a<i;a++)if(n=r[a],n.element===t.element&&n.name===t.name)return n;return null}},{key:"add",value:function(e){if(this.elements.has(e.element)||this.elements.set(e.element,new Map),!this.elements.get(e.element).has(e.names[0]))this.elements.get(e.element).set(e.names[0],e);else return!1;e.scope in this.data||(this.data[e.scope]={}),e.path in this.data[e.scope]||(this.data[e.scope][e.path]=[]),this.data[e.scope][e.path].push(e)}},{key:"remove",value:function(e){if((this.elements.has(e.element)&&(this.elements.get(e.element).has(e.names[0])&&this.elements.get(e.element).remove(e.names[0]),0===this.elements.get(e.elements).length&&this.elements.remove(e.elements)),!!(e.scope in this.data))&&e.path in this.data[e.scope])for(var t=this.data[e.scope][e.path],n=0,r=t.length;n<r;n++)if(t[n].element===e.element)return t.splice(n,1)}},{key:"each",value:function(e,n){var r="string"==typeof e?e.split("."):e,a=r[0],l=this.data[a];if(l){var i=r.slice(1).join(".");for(var o in l)if(""===i||0===o.indexOf(i)&&(o===i||"."===o.charAt(i.length)))for(var s=l[o],d=0,c=s.length;d<c;d++)n(s[d])}}},{key:"piper",value:function(e,t){if(!e.pipes.length)return t;var n=g.get(e.scope);if(!n)return t;for(var r,a=0,i=e.pipes.length;a<i;a++)if(r=e.pipes[a],r in n)t=n[r].call(e.container,t);else throw new Error("Oxe - pipe method "+r+" not found in scope "+e.scope);return t}},{key:"skipChildren",value:function(e){if("#document-fragment"===e.nodeName)return!1;if("STYLE"===e.nodeName&&"SCRIPT"===e.nodeName&&"OBJECT"===e.nodeName&&"IFRAME"===e.nodeName)return!0;for(var t,n=0,r=e.attributes.length;n<r;n++)if(t=e.attributes[n],0===t.name.indexOf("o-each"))return!0;return!1}},{key:"eachElement",value:function(e,t){if("SLOT"!==e.nodeName&&"O-ROUTER"!==e.nodeName&&"TEMPLATE"!==e.nodeName&&"#document-fragment"!==e.nodeName&&t.call(this,e),!this.skipChildren(e))for(e=e.firstElementChild;e;)this.eachElement(e,t),e=e.nextElementSibling}},{key:"eachAttribute",value:function(e,t){for(var n,r=e.attributes,a=0,i=r.length;a<i;a++)n=r[a],0===n.name.indexOf("o-")&&"o-scope"!==n.name&&"o-reset"!==n.name&&"o-action"!==n.name&&"o-method"!==n.name&&"o-enctype"!==n.name&&t.call(this,n)}},{key:"unbind",value:function(e,t,n){if(!n)throw new Error("Oxe - unbind requires scope argument");if(!e)throw new Error("Oxe - unbind requires element argument");if(!t)throw new Error("Oxe - unbind requires container argument");this.eachElement(e,function(e){this.eachAttribute(e,function(r){var a=this.get({scope:n,element:e,container:t,name:r.name,value:r.value});this.remove(a),Unrender.default(a)})})}},{key:"bind",value:function(e,t,n){if(!n)throw new Error("Oxe - bind requires scope argument");if(!e)throw new Error("Oxe - bind requires element argument");if(!t)throw new Error("Oxe - bind requires container argument");this.eachElement(e,function(e){this.eachAttribute(e,function(r){var a=this.create({scope:n,element:e,container:t,name:r.name,value:r.value}),l=this.add(a);!1!==l&&b.default(a)})})}}]),e}(),k=new v,x=function(){function e(){_classCallCheck(this,e),this.GET=2,this.SET=3,this.REMOVE=4,this.ran=!1,this.data=p.create({},this.listener.bind(this))}return _createClass(e,[{key:"traverse",value:function(e,t,n){var r;"string"==typeof t&&(t=t.split("."));for(var a=this.data,o=t[t.length-1],s=0,i=t.length-1;s<i;s++){if(!(t[s]in a)){if(e===this.GET||e===this.REMOVE)return;e===this.SET&&a.$set(t[s],isNaN(t[s+1])?{}:[])}a=a[t[s]]}return e===this.SET?r=a.$set(o,n):e===this.GET?r=a[o]:e===this.REMOVE&&(r=a[o],a.$remove(o)),r}},{key:"get",value:function(e){return this.traverse(this.GET,e)}},{key:"remove",value:function(e){return this.traverse(this.REMOVE,e)}},{key:"set",value:function(e,t){return this.traverse(this.SET,e,t)}},{key:"listener",value:function(e,t,n){var r=void 0===e?h:b;if("length"===n){var a=t.split(".").slice(0,1).join("."),l=t.split(".").slice(1).join(".");if(!(a in k.data))return;if(!(l in k.data[a]))return;if(!(0 in k.data[a][l]))return;var i=k.data[a][l][0];r.default(i)}else k.each(t,function(e){r.default(e)})}}]),e}(),O=new x,E=function(){function e(){_classCallCheck(this,e),this.head=null,this.method="get",this.mime={xml:"text/xml; charset=utf-8",html:"text/html; charset=utf-8",text:"text/plain; charset=utf-8",json:"application/json; charset=utf-8",js:"application/javascript; charset=utf-8"}}return _createClass(e,[{key:"setup",value:function(e){e=e||{},this.head=e.head||this.head,this.method=e.method||this.method,this.path=e.path,this.origin=e.origin,this.request=e.request,this.response=e.response,this.acceptType=e.acceptType,this.credentials=e.credentials,this.contentType=e.contentType,this.responseType=e.responseType}},{key:"serialize",value:_async(function(e){var t="";for(var n in e)t=0<t.length?t+"&":t,t=t+encodeURIComponent(n)+"="+encodeURIComponent(e[n]);return t})},{key:"fetch",value:_async(function(e){var t=this,n=!1,r=Object.assign({},e);if(r.path=r.path||t.path,r.origin=r.origin||t.origin,r.path&&"string"==typeof r.path&&"/"===r.path.charAt(0)&&(r.path=r.path.slice(1)),r.origin&&"string"==typeof r.origin&&"/"===r.origin.charAt(r.origin.length-1)&&(r.origin=r.origin.slice(0,-1)),r.path&&r.origin&&!r.url&&(r.url=r.origin+"/"+r.path),!r.url)throw new Error("Oxe.fetcher - requires url or origin and path option");if(!r.method)throw new Error("Oxe.fetcher - requires method option");if(!r.head&&t.head&&(r.head=t.head),"string"==typeof r.method&&(r.method=r.method.toUpperCase()||t.method),!r.acceptType&&t.acceptType&&(r.acceptType=t.acceptType),!r.contentType&&t.contentType&&(r.contentType=t.contentType),!r.responseType&&t.responseType&&(r.responseType=t.responseType),!r.credentials&&t.credentials&&(r.credentials=t.credentials),!r.mode&&t.mode&&(r.mode=t.mode),!r.cache&&t.cache&&(r.cahce=t.cache),!r.redirect&&t.redirect&&(r.redirect=t.redirect),!r.referrer&&t.referrer&&(r.referrer=t.referrer),!r.referrerPolicy&&t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),!r.signal&&t.signal&&(r.signal=t.signal),!r.integrity&&t.integrity&&(r.integrity=t.integrity),!r.keepAlive&&t.keepAlive&&(r.keepAlive=t.keepAlive),r.contentType)switch(r.head=r.head||{},r.contentType){case"js":r.head["Content-Type"]=t.mime.js;break;case"xml":r.head["Content-Type"]=t.mime.xml;break;case"html":r.head["Content-Type"]=t.mime.html;break;case"json":r.head["Content-Type"]=t.mime.json;break;default:r.head["Content-Type"]=r.contentType;}if(r.acceptType)switch(r.head=r.head||{},r.acceptType){case"js":r.head.Accept=t.mime.js;break;case"xml":r.head.Accept=t.mime.xml;break;case"html":r.head.Accept=t.mime.html;break;case"json":r.head.Accept=t.mime.json;break;default:r.head.Accept=r.acceptType;}return _invoke(function(){if("function"==typeof t.request){var e=Object.assign({},r);return _await(t.request(e),function(e){return!1===e?(n=!0,r):void("object"===("undefined"==typeof e?"undefined":_typeof(e))&&Object.assign(r,e))})}},function(e){return n?e:_invoke(function(){if(r.body)return _invokeIgnored(function(){if("GET"===r.method){var e=r.url+"?";return _await(t.serialize(r.body),function(t){r.url=e+t})}"json"===r.contentType&&(r.body=JSON.stringify(r.body))})},function(){var e=Object.assign({},r);return e.head&&(e.headers=e.head,delete e.head),_await(window.fetch(r.url,e),function(e){return r.code=e.status,r.message=e.statusText,_invoke(function(){return r.responseType?_await(e["buffer"===r.responseType?"arrayBuffer":r.responseType](),function(e){r.body=e}):void(r.body=e.body)},function(){var e=!1;return _invoke(function(){if(t.response){var n=Object.assign({},r);return _await(t.response(n),function(t){return!1===t?(e=!0,r):void("object"===("undefined"==typeof t?"undefined":_typeof(t))&&Object.assign(r,t))})}},function(t){return e?t:r})})})})})})},{key:"post",value:_async(function(e){var t=this;return e.method="post",t.fetch(e)})},{key:"get",value:_async(function(e){var t=this;return e.method="get",t.fetch(e)})},{key:"put",value:_async(function(e){var t=this;return e.method="put",t.fetch(e)})},{key:"head",value:_async(function(e){var t=this;return e.method="head",t.fetch(e)})},{key:"patch",value:_async(function(e){var t=this;return e.method="patch",t.fetch(e)})},{key:"delete",value:_async(function(e){var t=this;return e.method="delete",t.fetch(e)})},{key:"options",value:_async(function(e){var t=this;return e.method="options",t.fetch(e)})},{key:"connect",value:_async(function(e){var t=this;return e.method="connect",t.fetch(e)})}]),e}(),w=new E,T={extension:function(e){var t=e.lastIndexOf(".");return 0<t?e.slice(t+1):""},join:function(){return Array.prototype.join.call(arguments,"/").replace(/\/{2,}/g,"/").replace(/^(https?:\/)/,"$1/")},base:function(e){var t=window.document.querySelector("base");return e&&(t?t.href=e:(t=window.document.createElement("base"),t.href=e,window.document.head.insertBefore(t,window.document.head.firstElementChild))),t?t.href:window.location.origin+window.location.pathname},resolve:function(e,t){var n=[];if(e=e.replace(window.location.origin,""),0===e.indexOf("http://")||0===e.indexOf("https://")||0===e.indexOf("//"))return e;"/"!==e.charAt(0)&&(t=t||this.base(),e=t+"/"+e,e=e.replace(window.location.origin,"")),e=e.replace(/\/{2,}/,"/"),e=e.replace(/^\//,""),e=e.replace(/\/$/,"");for(var r=e.split("/"),a=0,i=r.length;a<i;a++)if("."===r[a]||""===r[a])continue;else".."===r[a]?0<a&&n.splice(a-1,1):n.push(r[a]);return"/"+n.join("/")}},S={innerHandler:function(e,t,n){return"\\"===n[t-1]?void 0:"'"===e?"\\'":"\""===e?"\\\"":"\t"===e?"\\t":"\r"===e?"\\r":"\n"===e?"\\n":"w"===e?"\\w":"\b"===e?"\\b":void 0},updateString:function(e,t,n){return n.slice(0,t)+e+n.slice(t+1)},updateIndex:function(e,t){return t+e.length-1},template:function(e){var t=e.indexOf("`"),n=e.indexOf("`",t+1);if(-1===t||-1===n)return e;for(var r,a=void 0,l=0,i=0,o=e,s=!1,d=0;d<o.length;d++)r=o[d],"`"===r&&"\\"!==o[d-1]?s?(l++,a="'",s=!1,o=this.updateString(a,d,o),d=this.updateIndex(a,d)):(i++,a="'",s=!0,o=this.updateString(a,d,o),d=this.updateIndex(a,d)):s&&(a=this.innerHandler(r,d,o))&&(o=this.updateString(a,d,o),d=this.updateIndex(a,d));if(o=o.replace(/\${(.*?)}/g,"'+$1+'"),i==l)return o;throw new Error("Oxe - Transformer missing backtick")},patterns:{exps:/export\s+(?:default|var|let|const)?\s+/g,imps:/import(?:\s+(?:\*\s+as\s+)?\w+\s+from)?\s+(?:'|").*?(?:'|")/g,imp:/import(?:\s+(?:\*\s+as\s+)?(\w+)\s+from)?\s+(?:'|")(.*?)(?:'|")/},getImports:function(e,t){for(var n,r=[],a=e.match(this.patterns.imps)||[],o=0,i=a.length;o<i;o++)n=a[o].match(this.patterns.imp),r[o]={raw:n[0],name:n[1],url:T.resolve(n[2],t),extension:T.extension(n[2])},r[o].extension||(r[o].url+=".js");return r},getExports:function(e){for(var t,n=[],r=e.match(this.patterns.exps)||[],a=0,i=r.length;a<i;a++)t=r[a],n[a]={raw:t,default:-1!==t.indexOf("default")};return n},replaceImports:function(e,t){if(!t.length)return e;for(var n=0,r=t.length;n<r;n++){var a=t[n],l=(a.name?"var "+a.name+" = ":"")+"$LOADER.data['"+a.url+"'].result";e=e.replace(a.raw,l)}return e},replaceExports:function(e,t){if(!t.length)return e;if(1===t.length)return e.replace(t[0].raw,"return ");e="var $EXPORT = {};\n"+e,e+="\nreturn $EXPORT;\n";for(var n=0,r=t.length;n<r;n++)e=e.replace(t[n].raw,"$EXPORT.");return e},ast:function(e){var t={};return t.url=e.url,t.raw=e.text,t.cooked=e.text,t.base=t.url.slice(0,t.url.lastIndexOf("/")+1),t.imports=this.getImports(t.raw,t.base),t.exports=this.getExports(t.raw),t.cooked=this.replaceImports(t.cooked,t.imports),t.cooked=this.replaceExports(t.cooked,t.exports),t}},A=function(){function e(){_classCallCheck(this,e),this.events={}}return _createClass(e,[{key:"on",value:function(e,t){e in this.events||(this.events[e]=[]),this.events[e].push(t)}},{key:"off",value:function(e,t){if(e in this.events){var n=this.events[e].indexOf(t);-1!==n&&this.events[e].splice(n,1)}}},{key:"emit",value:function(e){if(e in this.events)for(var t=this.events[e],n=Array.prototype.slice.call(arguments,1),r=0,a=t.length;r<a;r++)t[r].apply(this,n)}}]),e}(),C=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.data={},e.ran=!1,e.methods={},e.transformers={},e}return _inherits(t,e),_createClass(t,[{key:"setup",value:_async(function(e){var t=this,n=t;if(e=e||{},n.methods=e.methods||n.methods,n.transformers=e.transformers||n.transformers,e.loads)return Promise.all(e.loads.map(function(e){return n.load(e)}))})},{key:"execute",value:_async(function(e){var t=this,n="'use strict';\n\n"+(e.ast?e.ast.cooked:e.text),r=new Function("$LOADER","window",n);e.result=r(t,window)})},{key:"transform",value:_async(function(e){var t=this;if(("es"===e.transformer||"est"===e.transformer)&&(e.text=S.template(e.text)),("es"===e.transformer||"esm"===e.transformer)&&(e.ast=S.ast(e)),e.ast&&e.ast.imports.length)return Promise.all(e.ast.imports.map(function(n){return t.load({url:n.url,method:e.method,transformer:e.transformer})}))})},{key:"fetch",value:_async(function(e){return _await(window.fetch(e.url),function(t){return function(){if(200<=t.status&&300>t.status||304==t.status)return _await(t.text(),function(t){e.text=t});throw new Error(t.statusText)}()})})},{key:"attach",value:_async(function(e){return new Promise(function(t,n){var r=document.createElement(e.tag);for(var a in e.attributes)r.setAttribute(a,e.attributes[a]);r.onload=t,r.onerror=n,document.head.appendChild(r)})})},{key:"js",value:_async(function(e){var t=this,n=!1;return _invoke(function(){if("fetch"===e.method||"es"===e.transformer||"est"===e.transformer||"esm"===e.transformer)return _await(t.fetch(e),function(){return _invoke(function(){if(e.transformer)return _awaitIgnored(t.transform(e))},function(){return n=!0,_await(t.execute(e))})})},function(r){var a=!1;return n?r:_invoke(function(){if("script"===e.method)return a=!0,_await(t.attach({tag:"script",attributes:{src:e.url,type:"text/javascript"}}))},function(n){return a?n:_awaitIgnored(t.attach({tag:"script",attributes:{src:e.url,type:"module"}}))})})})},{key:"css",value:_async(function(e){var t=this;return _invokeIgnored(function(){return"fetch"===e.method?_awaitIgnored(t.fetch(e)):_awaitIgnored(t.attach({tag:"link",attributes:{href:e.url,type:"text/css",rel:"stylesheet"}}))})})},{key:"load",value:_async(function(e){var t=this,n=!1;return"string"==typeof e&&(e={url:e}),e.url=T.resolve(e.url),_invoke(function(){if(e.url in t.data)return _await(t.data[e.url].promise(),function(){return n=!0,t.data[e.url].result})},function(r){return n?r:(t.data[e.url]=e,e.extension=e.extension||T.extension(e.url),e.method=e.method||t.methods[e.extension],e.transformer=e.transformer||t.transformers[e.extension],e.promise="js"===e.extension?t.js.bind(t,e):"css"===e.extension?t.css.bind(t,e):t.fetch.bind(t,e),_await(e.promise(),function(){return e.result}))})})}]),t}(A),_=new C,P=function(){function e(){_classCallCheck(this,e),this.data={},this.compiled=!1}return _createClass(e,[{key:"setup",value:function(e){if(e=e||{},e.components&&e.components.length)for(var t=0,n=e.components.length;t<n;t++)this.define(e.components[t])}},{key:"renderSlot",value:function(e,t){for(var n=e.querySelectorAll("slot[name]"),r=0,a=n.length;r<a;r++){var l=n[r],i=l.getAttribute("name"),o=t.querySelector("[slot=\""+i+"\"]");o?l.parentNode.replaceChild(o,l):l.parentNode.removeChild(l)}var s=e.querySelector("slot:not([name])");if(s){if(t.children.length)for(s.parentNode.setAttribute("slot","default");t.firstChild;)s.parentNode.insertBefore(t.firstChild,s);s.parentNode.removeChild(s)}}},{key:"renderStyle",value:function(e,t){if(!e)return"";if(!window.CSS||!window.CSS.supports||!window.CSS.supports("(--t: black)"))for(var n=e.match(/--\w+(?:-+\w+)*:\s*.*?;/g),r=0,a=n.length;r<a;r++){var l=n[r],i=l.match(/(--\w+(?:-+\w+)*):\s*(.*?);/),o=new RegExp("var\\("+i[1]+"\\)","g");e=e.replace(i[0],""),e=e.replace(o,i[2])}return window.CSS&&window.CSS.supports&&window.CSS.supports(":scope")||(e=e.replace(/\:scope/g,"[o-scope=\""+t+"\"]")),window.CSS&&window.CSS.supports&&window.CSS.supports(":host")||(e=e.replace(/\:host/g,"[o-scope=\""+t+"\"]")),"<style type=\"text/css\">"+e+"</style>"}},{key:"render",value:function(e,t){var n=this;if(e.setAttribute("o-scope",e.scope),n.compiled&&"O-ROUTER"===e.parentElement.nodeName)k.bind(e,e,e.scope);else{var r=document.createElement("template"),a=n.renderStyle(t.style,e.scope);"string"==typeof t.template?r.innerHTML=a+t.template:(r.innerHTML=a,r.appendChild(t.template));var l=document.importNode(r.content,!0);k.bind(l,e,e.scope),t.shadow?"attachShadow"in document.body?e.attachShadow({mode:"open"}).appendChild(l):"createShadowRoot"in document.body&&e.createShadowRoot().appendChild(l):(n.renderSlot(l,e),e.appendChild(l))}}},{key:"define",value:function(e){var t=this;if(!e.name)throw new Error("Oxe.component.define - requires name");if(e.name in t.data)throw new Error("Oxe.component.define - component previously defined");t.data[e.name]=e,e.count=0,e.compiled=!1,e.style=e.style||"",e.model=e.model||{},e.methods=e.methods||{},e.shadow=e.shadow||!1,e.template=e.template||"",e.properties=e.properties||{},e.construct=function(){var t=window.Reflect.construct(HTMLElement,[],this.constructor);return e.properties.created={value:!1,enumerable:!0,configurable:!0},e.properties.scope={enumerable:!0,value:e.name+"-"+e.count++},e.properties.model={enumerable:!0,get:function(){return O.get(this.scope)},set:function(e){return e=e&&"object"===("undefined"==typeof e?"undefined":_typeof(e))?e:{},O.set(this.scope,e)}},e.properties.methods={enumerable:!0,get:function(){return g.get(this.scope)}},Object.defineProperties(t,e.properties),O.set(t.scope,e.model),g.set(t.scope,e.methods),t},e.construct.prototype.attributeChangedCallback=function(){e.attributed&&e.attributed.apply(this,arguments)},e.construct.prototype.adoptedCallback=function(){e.adopted&&e.adopted.call(this)},e.construct.prototype.connectedCallback=function(){this.created||(t.render(this,e),Object.defineProperty(this,"created",{value:!0,enumerable:!0,configurable:!1}),e.created&&e.created.call(this)),e.attached&&e.attached.call(this)},e.construct.prototype.disconnectedCallback=function(){e.detached&&e.detached.call(this)},Object.setPrototypeOf(e.construct.prototype,HTMLElement.prototype),Object.setPrototypeOf(e.construct,HTMLElement),window.customElements.define(e.name,e.construct)}}]),e}(),$=new P,j=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.data=[],e.ran=!1,e.location={},e.mode="push",e.element=null,e.contain=!1,e.folder="./routes",e.parser=document.createElement("a"),e}return _inherits(t,e),_createClass(t,[{key:"isPath",value:function(e,t){if(t=t||"/",("index"===e||"/index"===e)&&(e="/"),("index"===t||"/index"===t)&&(t="/"),"/"!==e.slice(0,1)&&(e=T.resolve(e)),t.constructor===String){for(var n=t.split("/"),r=e.split("/"),a=0,i=r.length;a<i;a++)if(0===r[a].indexOf("{")&&r[a].indexOf("}")===r[a].length-1)continue;else if(r[a]!==n[a])return!1;return!0}return t.constructor===RegExp?t.test(e):void 0}},{key:"toParameterObject",value:function(e,t){var n={};if(!e||!t||"/"===e||"/"===t)return n;for(var r=/{|}/g,a=/{(\w+)}/,o=t.split("/"),s=e.split("/"),d=0,i=s.length;d<i;d++)if(a.test(s[d])){var l=s[d].replace(r,"");n[l]=o[d]}return n}},{key:"toQueryString",value:function(e){var t="?";for(var n in e){var r=e[n];t+=n+"="+r+"&"}return"&"===t.slice(-1)&&(t=t.slice(0,-1)),t}},{key:"toQueryObject",value:function(e){var t={};0===e.indexOf("?")&&(e=e.slice(1));for(var n,r=e.split("&"),a=0,i=r.length;a<i;a++)n=r[a].split("="),n[0]&&n[1]&&(t[n[0]]=n[1]);return t}},{key:"toLocationObject",value:function(e){var t={};return this.parser.href=e,t.href=this.parser.href,t.host=this.parser.host,t.port=this.parser.port,t.hash=this.parser.hash,t.search=this.parser.search,t.protocol=this.parser.protocol,t.hostname=this.parser.hostname,t.pathname="/"===this.parser.pathname[0]?this.parser.pathname:"/"+this.parser.pathname,t.path=t.pathname+t.search+t.hash,t}},{key:"scroll",value:function(e,t){window.scroll(e,t)}},{key:"back",value:function(){window.history.back()}},{key:"forward",value:function(){window.history.forward()}},{key:"redirect",value:function(e){window.location.href=e}},{key:"setup",value:_async(function(e){var t=this;if(e=e||{},t.mode=void 0===e.mode?t.mode:e.mode,t.after=void 0===e.after?t.after:e.after,t.folder=void 0===e.folder?t.folder:e.folder,t.before=void 0===e.before?t.before:e.before,t.change=void 0===e.change?t.change:e.change,t.element=void 0===e.element?t.element:e.element,t.contain=void 0===e.contain?t.contain:e.contain,t.external=void 0===e.external?t.external:e.external,t.element&&"string"!=typeof t.element||(t.element=document.body.querySelector(t.element||"o-router")),!t.element)throw new Error("Oxe.router.render - missing o-router element");return _await(t.add(e.routes),function(){return _awaitIgnored(t.route(window.location.href,{mode:"replace"}))})})},{key:"load",value:_async(function(e){return _invoke(function(){if(e.load)return _await(_.load(e.load),function(t){e=Object.assign({},t,e)})},function(){return e.component&&(e.component.route=e),e})})},{key:"add",value:_async(function(e){var t=this;return function(){return e?function(){if(e.constructor===String){t.data.push({path:e,load:t.folder+"/"+e+".js"})}else return function(){if(e.constructor===Object){if(!e.path)throw new Error("Oxe.router.add - route path required");t.data.push(e)}else return _invokeIgnored(function(){if(e.constructor===Array){var n=0,r=e.length;return _continueIgnored(_for(function(){return n<r},function(){return n++},function(){return _awaitIgnored(t.add(e[n]))}))}})}()}():void 0}()})},{key:"remove",value:_async(function(e){for(var t=this,n=0,r=t.data.length;n<r;n++)t.data[n].path===e&&t.data.splice(n,1)})},{key:"get",value:_async(function(e){var t=this,n=!1,r=0,a=t.data.length;return _for(function(){return!n&&r<a},function(){return r++},function(){return function(){if(t.data[r].path===e)return _await(t.load(t.data[r]),function(e){return t.data[r]=e,n=!0,t.data[r]})}()})})},{key:"find",value:_async(function(e){var t=this,n=!1,r=0,a=t.data.length;return _for(function(){return!n&&r<a},function(){return r++},function(){return function(){if(t.isPath(t.data[r].path,e))return _await(t.load(t.data[r]),function(e){return t.data[r]=e,n=!0,t.data[r]})}()})})},{key:"render",value:_async(function(e){var t=this;if(!e)throw new Error("Oxe.render - route argument required. Missing object option.");if(!e.component&&!e.element)throw new Error("Oxe.render - route property required. Missing component or element option.");if(e.title&&(document.title=e.title),e.description&&y.ensureElement({name:"meta",scope:document.head,position:"afterbegin",query:"[name=\"description\"]",attributes:[{name:"name",value:"description"},{name:"content",value:e.description}]}),e.keywords&&y.ensureElement({name:"meta",scope:document.head,position:"afterbegin",query:"[name=\"keywords\"]",attributes:[{name:"name",value:"keywords"},{name:"content",value:e.keywords}]}),e.element||(e.component.constructor===String?e.element=document.createElement(e.component):e.component.constructor===Object&&($.define(e.component),e.element="compiled"===t.mode?t.element.firstElementChild:document.createElement(e.component.name))),e.element!==t.element.firstElementChild){for(;t.element.firstChild;)t.element.removeChild(t.element.firstChild);t.element.appendChild(e.element)}t.scroll(0,0)})},{key:"route",value:_async(function(e,t){var n=this;t=t||{},t.query&&(e+=n.toQueryString(t.query));var r=t.mode||n.mode,a=n.toLocationObject(e);return _await(n.find(a.pathname),function(e){var t=!1;if(!e)throw new Error("Oxe.router.route - missing route "+a.pathname);return a.route=e,a.title=a.route.title,a.query=n.toQueryObject(a.search),a.parameters=n.toParameterObject(a.route.path,a.pathname),_invoke(function(){if(a.route&&a.route.handler)return t=!0,_await(a.route.handler(a))},function(e){return t?e:a.route&&a.route.redirect?n.redirect(a.route.redirect):_invoke(function(){if("function"==typeof n.before)return _awaitIgnored(n.before(a))},function(){return(n.emit("route:before",a),"href"===r||"compiled"===r)?window.location.assign(a.path):(window.history[r+"State"]({path:a.path},"",a.path),n.location=a,_await(n.render(a.route),function(){return _invoke(function(){if("function"==typeof n.after)return _awaitIgnored(n.after(a))},function(){n.emit("route:after",a)})}))})})})})}]),t}(A),q=new j,N=function(){function e(){_classCallCheck(this,e),this.compiled=!1}return _createClass(e,[{key:"setup",value:function(e){e=e||{},e.base&&T.base(e.base)}}]),e}(),R=new N,L=document.createElement("style"),I=document.createTextNode("\n\to-router, o-router > :first-child {\n\t\tdisplay: block;\n\t\tanimation: o-transition 150ms ease-in-out;\n\t}\n\t@keyframes o-transition {\n\t\t0% { opacity: 0; }\n\t\t100% { opacity: 1; }\n\t}\n");L.setAttribute("type","text/css"),L.appendChild(I),document.head.appendChild(L),window.Reflect&&window.Reflect.construct||(window.Reflect=window.Reflect||{},window.Reflect.construct=function(e,t,n){var r=n===void 0?e:n,a=r.prototype||Object.prototype,l=Object.create(a);return Function.prototype.apply.call(e,l,t)||l});var V=function(){return window.Reflect.construct(HTMLElement,[],this.constructor)};Object.setPrototypeOf(V.prototype,HTMLElement.prototype),Object.setPrototypeOf(V,HTMLElement),window.customElements.define("o-router",V);var B=document.querySelector("script[o-setup]");if(B){var D=B.getAttribute("o-setup").split(/\s*,\s*/),M=document.querySelector("meta[name=\"oxe\"]");if(M&&M.hasAttribute("compiled")&&(D[1]="null",D[2]="script",q.mode="compiled",R.compiled=!0,$.compiled=!0),!D[0])throw new Error("Oxe - script attribute o-setup requires url");if(1<D.length)_.load({url:D[0],method:D[2],transformer:D[1]}).catch(console.error);else{var U=document.createElement("script");U.setAttribute("src",D[0]),U.setAttribute("async","true"),U.setAttribute("type","module"),document.head.appendChild(U)}}var H=function(){function e(){_classCallCheck(this,e),this.g={}}return _createClass(e,[{key:"setup",value:_async(function(e){var t=this;if(!t._setup)return t._setup=!0,e=e||{},e.listener=e.listener||{},document.addEventListener("input",l,!0),document.addEventListener("click",i,!0),document.addEventListener("change",a,!0),window.addEventListener("popstate",o,!0),document.addEventListener("reset",function(t){if(t.target.hasAttribute("o-reset")){t.preventDefault();var n,r;e.listener.reset&&(n="function"==typeof e.listener.reset.before?e.listener.reset.before.bind(null,t):null,r="function"==typeof e.listener.reset.after?e.listener.reset.after.bind(null,t):null),Promise.resolve().then(n).then(s.bind(null,t)).then(r).catch(console.error)}},!0),document.addEventListener("submit",function(t){if(t.target.hasAttribute("o-submit")){t.preventDefault();var n,r;e.listener.submit&&(n="function"==typeof e.listener.submit.before?e.listener.submit.before.bind(null,t):null,r="function"==typeof e.listener.submit.after?e.listener.submit.after.bind(null,t):null),Promise.resolve().then(n).then(d.bind(null,t)).then(r).catch(console.error)}},!0),_invoke(function(){if(e.listener.before)return _awaitIgnored(e.listener.before())},function(){return e.general&&t.general.setup(e.general),e.fetcher&&t.fetcher.setup(e.fetcher),_invoke(function(){if(e.loader)return _awaitIgnored(t.loader.setup(e.loader))},function(){return _invoke(function(){if(e.component)return _awaitIgnored(t.component.setup(e.component))},function(){return _invoke(function(){if(e.router)return _awaitIgnored(t.router.setup(e.router))},function(){return _invokeIgnored(function(){if(e.listener.after)return _awaitIgnored(e.listener.after())})})})})})})},{key:"global",get:function(){return this.g}},{key:"window",get:function(){return window}},{key:"document",get:function(){return window.document}},{key:"body",get:function(){return window.document.body}},{key:"head",get:function(){return window.document.head}},{key:"location",get:function(){return this.router.location}},{key:"currentScript",get:function(){return window.document._currentScript||window.document.currentScript}},{key:"ownerDocument",get:function(){return(window.document._currentScript||window.document.currentScript).ownerDocument}},{key:"render",get:function(){return b}},{key:"methods",get:function(){return g}},{key:"utility",get:function(){return y}},{key:"general",get:function(){return R}},{key:"batcher",get:function(){return m}},{key:"loader",get:function(){return _}},{key:"binder",get:function(){return k}},{key:"fetcher",get:function(){return w}},{key:"component",get:function(){return $}},{key:"router",get:function(){return q}},{key:"model",get:function(){return O}}]),e}(),F=new H;return F});