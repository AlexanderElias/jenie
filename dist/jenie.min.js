/*
			name: jenie
		version: 1.4.17
		license: mpl-2.0
		author: alexander elias

		This Source Code Form is subject to the terms of the Mozilla Public
		License, v. 2.0. If a copy of the MPL was not distributed with this
		file, You can obtain one at http://mozilla.org/MPL/2.0/.
	*/
(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define('Jenie',b):a.Jenie=b()})(this,function(){'use strict';function a(F,G,H){return b(F,G,H,!0),F}function b(F,G,H,I){for(var J in H=H?H+'.':'',F)d(F,J,F[J],G,H,I);F.constructor===Object?g(F,G,H):F.constructor===Array&&h(F,G,H)}function d(F,G,H,I,J,K){var L=Object.getOwnPropertyDescriptor(F,G);if(!(L&&!1===L.configurable)){var M=L&&L.get,N=L&&L.set;return H&&'object'==typeof H&&b(H,I,J+G,K),M&&N&&!1===K?N.call(F,H):void Object.defineProperty(F,G,{enumerable:!0,configurable:!0,get:function(){return M?M.call(F):H},set:function(O){var P=M?M.call(F):H;O===P||(N?N.call(F,O):H=O,O&&'object'==typeof O&&b(O,I,J+G,K),I&&I(O,J+G,G,F))}})}}function g(F,G,H){Object.defineProperties(F,{$set:{configurable:!0,value:function(I,J){if('string'==typeof I&&void 0!==J){d(F,I,J,G,H),!(I in F)&&G&&G(F[I],H+I,I,F)}}},$remove:{configurable:!0,value:function(I){'string'!=typeof I||(delete F[I],G&&G(void 0,H+I,I,F))}}})}function h(F,G,H){Object.defineProperties(F,{push:{configurable:!0,value:function(){if(!arguments.length||!F.length)return F.length;for(var I=0,J=arguments.length;I<J;I++)d(F,F.length,arguments[I],G,H),G&&(G(F.length,H+'length','length',F),G(F[F.length-1],H+(F.length-1),F.length-1,F));return F.length}},unshift:{configurable:!0,value:function(){if(!arguments.length||!F.length)return F.length;var I,J,K=[];for(I=0,J=arguments.length;I<J;I++)K.push(arguments[I]);for(I=0,J=F.length;I<J;I++)K.push(F[I]);for(I=0,J=F.length;I<J;I++)F[I]=K[I];for(I,J=K.length;I<J;I++)d(F,F.length,K[I],G,H),G&&(G(F.length,H+'length','length',F),G(F[F.length-1],H+(F.length-1),F.length-1,F));return F.length}},pop:{configurable:!0,value:function(){if(F.length){var I=F[F.length-1];return F.length--,G&&(G(F.length,H+'length','length',F),G(void 0,H+F.length,F.length,F)),I}}},shift:{configurable:!0,value:function(){if(F.length){for(var I=F[0],J=0,K=F.length-1;J<K;J++)F[J]=F[J+1];return F.length--,G&&(G(F.length,H+'length','length',F),G(void 0,H+F.length,F.length,F)),I}}},splice:{configurable:!0,value:function(I,J){if(!F.length||'number'!=typeof I&&'number'!=typeof J)return[];'number'!=typeof I&&(I=0),'number'!=typeof J&&(J=F.length);var M,N,O,K=[],L=[];for(0>I?(I=F.length+I,I=0<I?I:0):I=I<F.length?I:F.length,0>J?J=0:J>F.length-I&&(J=F.length-I),N=0;N<I;N++)L[N]=F[N];for(N=2,O=arguments.length;N<O;N++)L.push(arguments[N]);for(N=I,O=I+J;N<O;N++)K.push(F[N]);for(N=I+J,O=F.length;N<O;N++)L.push(F[N]);for(M=0,N=L.length-F.length,N=L.length-(0>N?0:N);N--;)F[M]=L[M],M++;if(N=L.length-F.length,0<N)for(;N--;)d(F,F.length,L[M++],G,H),G&&(G(F.length,H+'length','length',F),G(F[F.length-1],H+(F.length-1),F.length-1,F));else if(0>N)for(;N++;)F.length--,G&&(G(F.length,H+'length','length',F),G(void 0,H+F.length,F.length,F));return K}}})}function j(F){var G=this;G.isRan=!1,G.controller=F.controller}function k(F){Object.defineProperty(this,'data',{value:F||[]})}function m(){}function n(F){this.element=F.element,this.attribute=F.attribute,this.controller=F.controller,this.renderType=this.attribute.cmds[0]||'default','on'===this.renderType?this.data=B.getByPath(this.controller.events,this.attribute.path).bind(this.controller.model.data):(this.modifiers=this.attribute.modifiers.map(function(G){return this.controller.modifiers[G]},this),this.paths=this.attribute.path.split('.'),this.key=this.paths.slice(-1)[0],this.path=this.paths.slice(0,-1).join('.'),this.data=this.path?B.getByPath(this.controller.model.data,this.path):this.controller.model.data,'value'===this.attribute.cmds[0]&&this.data&&this.data[this.key]===void 0&&(this.data.$set(this.key,null),this.updateModel())),this.render()}function o(F){var G=this;G.isRan=!1,G.data=new k,G.controller=F.controller}function p(F,G){var H=this;H.name=F.name||'',H.events=F.events||{},H.modifiers=F.modifiers||{},H._model=F.model||{},H._view=F.view.shadowRoot||F.view,H.view=new o({controller:H}),H.model=new j({controller:H}),'function'==typeof H._model?H._model.call(H,function(I){H._model=I,H.model.run(),H.view.run(),G&&G.call(H)}):(H.model.run(),H.view.run(),G&&G.call(H))}function q(F){var G=this;if(F=F||{},!F.name)throw new Error('Component missing options.name');if(!F.template)throw new Error('Component missing options.template');G.name=F.name,G.model=F.model,G.style=F.style,G.events=F.events,G.modifiers=F.modifiers,G.currentScript=document._currentScript||document.currentScript,G.template=G.toTemplate(F.template),G.proto=Object.create(HTMLElement.prototype),G.proto.attachedCallback=F.attached,G.proto.detachedCallback=F.detached,G.proto.attributeChangedCallback=F.attributed,G.proto.createdCallback=function(){G.element=this,G.element.uuid=D(),G.slotify(),G.element.appendChild(document.importNode(G.template.content,!0)),G.model||G.events||G.modifiers?G.element.controller=new p({model:G.model,view:G.element,events:G.events,name:G.element.uuid,modifiers:G.modifiers},function(){var H=this;G.element.view=H.view.data,Object.defineProperty(G.element,'model',{enumerable:!0,configurable:!0,set:function(I){H.model.overwrite(I)},get:function(){return H.model.data}}),F.created&&F.created.call(G.element)}):F.created&&F.created.call(G.element)},G.define()}function t(){this.events={}}function u(F){this.setup(F||{})}function v(F){t.call(this),this.state={},this.cache={},this.location={},this.loader=new u,this.setup(F||{})}function w(F){this.setup(F||{})}function z(F){this.setup(F||{})}function A(){var G=document.createElement('style'),H=document.createTextNode('j-view, j-view > :first-child { display: block; }');G.appendChild(H),document.head.appendChild(G),document.registerElement('j-view',{prototype:Object.create(HTMLElement.prototype)}),this.http=new z,this.loader=new u,this.module=new w,this.router=new v}j.prototype.listener=function(F,G){var H=this,I=new RegExp('^'+G);F===void 0?H.controller.view.unrender(I):H.controller.view.render(I)},j.prototype.overwrite=function(F){var G=this;G.data=F,a(G.data,G.listener.bind(G))},j.prototype.run=function(){var F=this;F.isRan||(F.isRan=!0,F.data=F.controller._model,a(F.data,F.listener.bind(F)))},k.prototype.find=function(F){for(var G=0,H=this.data.length;G<H;G++)if(!0===F(this.data[G][1],this.data[G][0],G))return this.data[G][1]},k.prototype.get=function(F){for(var G=0,H=this.data.length;G<H;G++)if(F===this.data[G][0])return this.data[G][1]},k.prototype.remove=function(F){return this.data.splice(F,1)},k.prototype.has=function(F){for(var G=0,H=this.data.length;G<H;G++)if(F===this.data[G][0])return!0;return!1},k.prototype.set=function(F,G){for(var H=0,I=this.data.length;H<I;H++)if(F===this.data[H][0])return this.data[H][1]=G;return this.data[this.data.length]=[F,G]},k.prototype.push=function(F){return arguments.length?(this.data[this.data.length]=[this.data.length,F],this.data.length):this.length},k.prototype.size=function(){return this.data.length},k.prototype.forEach=function(F){for(var G=0,H=this.data.length;G<H;G++)F(this.data[G][1],this.data[G][0],G,this.data)},m.prototype.setByPath=function(F,G,H){for(var L,I=G.split('.'),J=I.length-1,K=0;K<J;K++)L=I[K],void 0===F[L]&&(F[L]={}),F=F[L];return F[I[J]]=H},m.prototype.getByPath=function(F,G){for(var H=G.split('.'),I=H.length-1,J=0;J<I;J++){if(!F[H[J]])return;F=F[H[J]]}return F[H[I]]},m.prototype.toCamelCase=function(F){return'Array'===F.constructor.name&&(F=F.join('-')),F.replace(/-[a-z]/ig,function(G){return G[1].toUpperCase()})};var B=new m;n.prototype.setData=function(F){if(void 0!==this.data){if(null!==F)for(var G=0,H=this.modifiers.length;G<H;G++)F=this.modifiers[G].call(F);return this.data[this.key]=F}},n.prototype.getData=function(){if(void 0!==this.data){var F=this.data[this.key];if(null!==F)for(var G=0,H=this.modifiers.length;G<H;G++)F=this.modifiers[G].call(F);return F}},n.prototype.updateModel=function(){if('checkbox'===this.element.type)this.element.value=this.element.checked,this.setData(this.element.checked);else if('SELECT'===this.element.nodeName&&this.element.multiple)this.setData(Array.prototype.filter.call(this.element.options,function(J){return J.selected}).map(function(J){return J.value}));else if('radio'===this.element.type)for(var I,F=this.element.parentNode.querySelectorAll('input[type="radio"][type="radio"][j-value="'+this.attribute.value+'"]'),G=0,H=F.length;G<H;G++)I=F[G],I===this.element?this.setData(G):I.checked=!1;else this.setData(this.element.value)},n.prototype.renderMethods={on:function(F){var G=this;G.element.removeEventListener(G.attribute.cmds[1],F),G.element.addEventListener(G.attribute.cmds[1],F)},each:function(F){var G=this;if(G.clone||(G.variable=G.attribute.cmds.slice(1).join('.'),G.clone=G.element.removeChild(G.element.children[0]).outerHTML,G.pattern=new RegExp('(((data-)?j(-(\\w)+)+="))'+G.variable+'(((\\.(\\w)+)+)?((\\s+)?\\|((\\s+)?(\\w)+)+)?(\\s+)?")','g')),G.element.children.length>F.length)for(;G.element.children.length>F.length;)G.element.removeChild(G.element.children[G.element.children.length-1]);else if(G.element.children.length<F.length)for(;G.element.children.length<F.length;)G.element.insertAdjacentHTML('beforeend',G.clone.replace(G.pattern,'$1'+G.attribute.path+'.'+G.element.children.length+'$6'))},value:function(F){if(!this.isSetup){var H,I,G=this;if('checkbox'===G.element.type&&G.element.checked!==F&&(G.element.value=F,G.element.checked=F),'SELECT'===G.element.nodeName&&G.element.multiple){if(G.element.options.length!==F.length){var J=G.element.options;for(H=0,I=J.length;H<I;H++){var K=J[H];K.value===F[H]&&K.selected}}}else if('radio'===G.element.type){var L=G.element.parentNode.querySelectorAll('input[type="radio"][type="radio"][j-value="'+G.attribute.value+'"]');for(H=0,I=L.length;H<I;H++){var M=L[H];M.checked=H===F}}else G.element.value=F;G.isSetup=!0}},html:function(F){var G=this;G.element.innerHTML=F},css:function(F){var G=F;1<this.attribute.cmds.length&&(G=this.attribute.cmds.slice(1).join('-')+': '+G+';'),this.element.style.cssText+=G},class:function(F){var G=this.attribute.cmds.slice(1).join('-');this.element.classList.toggle(G,F)},text:function(F){this.element.innerText=F},enable:function(F){this.element.disabled=!F},disable:function(F){this.element.disabled=F},show:function(F){this.element.hidden=!F},hide:function(F){this.element.hidden=F},write:function(F){this.element.readOnly=!F},read:function(F){this.element.readOnly=F},selected:function(F){this.element.selectedIndex=F},href:function(F){this.element.href=F},default:function(F){var G=B.toCamelCase(this.attribute.cmds);B.setByPath(this.element,G,F)}},n.prototype.unrenderMethods={on:function(F){this.element.removeEventListener(this.attribute.cmds[1],F,!1)},each:function(){for(;this.element.lastChild;)this.element.removeChild(this.element.lastChild)},html:function(){this.element.innerText=''},text:function(){this.element.innerText=''},default:function(){}},n.prototype.unrender=function(){var F=this,G='on'===F.renderType?F.data:void 0;return F.unrenderMethods[F.renderType].call(F,G),F},n.prototype.render=function(){var F=this,G='on'===F.renderType?F.data:F.getData();if(void 0!==G)return F.renderMethods[F.renderType].call(F,G),F},o.prototype.PATH=/\s?\|(.*?)$/,o.prototype.PREFIX=/(data-)?j-/,o.prototype.MODIFIERS=/^(.*?)\|\s?/,o.prototype.ATTRIBUTE_ACCEPTS=/(data-)?j-/i,o.prototype.ELEMENT_SKIPS=/^\w+(-\w+)+|iframe|object|script|style|svg/i,o.prototype.attribute=function(F,G){var H=this,I={};return I.name=F,I.value=G,I.path=I.value.replace(H.PATH,''),I.opts=I.path.split('.'),I.command=I.name.replace(H.PREFIX,''),I.cmds=I.command.split('-'),I.key=I.opts.slice(-1),I.vpath='each'===I.cmds[0]?I.path+'.length':I.path,I.modifiers=-1===I.value.indexOf('|')?[]:I.value.replace(H.MODIFIERS,'').split(' '),I},o.prototype.nodeSkipsTest=function(F){if(!F)return!1;var G=this;return G.ELEMENT_SKIPS.test(F.nodeName)},o.prototype.nodeAcceptsTest=function(F){if(!F)return!1;for(var G=this,H=F.attributes,I=0,J=H.length;I<J;I++)if(G.ATTRIBUTE_ACCEPTS.test(H[I].name))return!0;return!1},o.prototype.eachElement=function(F,G){for(var H=this,I=0,J=F.length;I<J;I++)H.nodeSkipsTest(F[I])?(I+=F[I].getElementsByTagName('*').length,G(F[I])):H.nodeAcceptsTest(F[I])&&G(F[I])},o.prototype.eachAttribute=function(F,G){for(var J,H=this,I=F.attributes,K=0,L=I.length;K<L;K++)J=I[K],H.ATTRIBUTE_ACCEPTS.test(J.name)&&G(H.attribute(J.name,J.value))},o.prototype.unrender=function(F){var G=this;G.data.forEach(function(H,I,J){F.test(I)&&(H.forEach(function(K,L,M){K.unrender(),H.remove(M)}),0===H.size()&&G.data.remove(J))})},o.prototype.render=function(F){var G=this;G.data.forEach(function(H,I){F.test(I)&&H.forEach(function(J){J.render()})})},o.prototype.addElement=function(F){var G=this;G.eachAttribute(F,function(H){G.data.has(H.vpath)||G.data.set(H.vpath,new k),G.data.get(H.vpath).push(new n({element:F,attribute:H,controller:G.controller}))})},o.prototype.addElements=function(F){var G=this;G.eachElement(F,function(H){G.addElement(H)})},o.prototype.mutationListener=function(F){var H,I,J,K,L,M,G=this;for(H=0,I=F.length;H<I;H++)for(M=F[H].addedNodes,J=0,K=M.length;J<K;J++)L=M[J],1===L.nodeType&&(G.addElements(L.getElementsByTagName('*')),G.addElement(L))},o.prototype.inputListener=function(F){var G=this,H=F.getAttribute('j-value');if(H){var I=G.attribute('j-value',H);G.data.get(I.path).find(function(J){return J.element===F}).updateModel()}},o.prototype.run=function(){var F=this;F.isRan||(F.isRan=!0,F.controller._view.addEventListener('change',function(G){('checkbox'===G.target.type||'radio'===G.target.type)&&'SELECT'!==G.target.nodeName&&F.inputListener.call(F,G.target)},!0),F.controller._view.addEventListener('input',function(G){F.inputListener.call(F,G.target)},!0),F.addElements(F.controller._view.getElementsByTagName('*')),F.observer=new MutationObserver(F.mutationListener.bind(F)),F.observer.observe(F.controller._view,{childList:!0,subtree:!0}))};var C='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split(''),D=function(F){var H,G=[];if(F)for(H=0;H<F;H++)G[H]=C[0|Math.random()*F];else{var I;for(G[8]='-',G[13]='-',G[14]='4',G[18]='-',G[23]='-',H=0;36>H;H++)G[H]||(I=0|16*Math.random(),G[H]=C[19==H?8|3&I:I])}return G.join('')};q.prototype.slotify=function(){for(var F=this.element.querySelectorAll('[slot]'),G=0,H=F.length;G<H;G++){var I=F[G],J=I.getAttribute('slot'),K=this.template.content.querySelector('slot[name='+J+']');K.parentNode.replaceChild(I,K)}},q.prototype.toHTML=function(F){var G=document.createElement('template');return G.innerHTML=F,G},q.prototype.toTemplate=function(F){return'String'===F.constructor.name&&(/<|>/.test(F)?F=this.toHTML(F):F=this.currentScript.ownerDocument.querySelector(F)),F},q.prototype.define=function(){document.registerElement(this.name,{prototype:this.proto})},t.prototype.on=function(F,G){'object'!=typeof this.events[F]&&(this.events[F]=[]),this.events[F].push(G)},t.prototype.off=function(F,G){if('object'==typeof this.events[F]){var H=this.events[F].indexOf(G);-1<H&&this.events[F].splice(H,1)}},t.prototype.once=function(F,G){this.on(F,function H(){this.off(F,H),G.apply(this,arguments)})},t.prototype.emit=function(F){if('object'==typeof this.events[F])for(var G=this.events[F].slice(),H=[].slice.call(arguments,1),I=0,J=G.length;I<J;I++)G[I].apply(this,H)},u.prototype.setup=function(F){this.loads={},this.counts={},F.loads&&F.loads.length&&this.insert(F.loads)},u.prototype.insert=function(F){for(var I,G=0,H=F.length;G<H;G++){if(I=F[G],!I.group)throw new Error('Missing load group');if(!I.path)throw new Error('Missing load path');I.execution||(I.execution='defer'),I.group in this.loads||(this.counts[I.group]=0,this.loads[I.group]=[]),this.loads[I.group].push(I)}},u.prototype.inject=function(F,G){if(F.done)return void(G&&G());var H;for(var I in F='string'==typeof F?{path:F}:F,F.attributes=F.attributes||{},F.attributes)H.setAttribute(I,F.attributes[I]);if(/\.css$/.test(F.path))H=document.createElement('link'),H.setAttribute('rel','stylesheet'),H.setAttribute('href',F.path);else if(/\.html$/.test(F.path))H=document.createElement('link'),H.setAttribute('rel','import'),H.setAttribute('href',F.path),'async'in F.attributes||'defer'in F.attributes||H.setAttribute('defer','');else if(/\.js$/.test(F.path))H=document.createElement('script'),H.setAttribute('src',F.path),'async'in F.attributes||'defer'in F.attributes||H.setAttribute('defer','');else throw new Error('Unrecognized extension');H.onload=G,document.head.appendChild(H),F.done=!0},u.prototype.listener=function(F,G){++this.counts[F]===this.loads[F].length&&G&&G()},u.prototype.start=function(F,G){if(!F)throw new Error('Missing inject group');if(!this.loads[F])return console.warn('Missing group');for(var H=0,I=this.loads[F].length;H<I;H++)this.inject(this.loads[F][H],this.listener.bind(this,F,G))},v.prototype=Object.create(t.prototype),v.prototype.constructor=v,v.prototype.setup=function(F){if(this.external=F.external,this.container=F.container,this.routes=F.routes||[],this.view=F.view||'j-view',this.started=!1,this.base=F.base||'',this.hash=void 0!==F.hash&&F.hash,this.trailing=void 0!==F.trailing&&F.trailing,this.base){var G=document.head.querySelector('base');G||(G=document.createElement('base'),document.head.insertBefore(G,document.head.firstChild)),'string'==typeof this.base&&(G.href=this.base),this.base=G.href}},v.prototype.joinPath=function(){return Array.prototype.join.call(arguments,'/').replace(/\/{2,}/g,'/').replace(/^(http(s)?:\/)/,'$1/')},v.prototype.testPath=function(F,G){return new RegExp('^'+F.replace(/{\*}/g,'(?:.*)').replace(/{(\w+)}/g,'([^/]+)')+'(/)?$').test(G)},v.prototype.popstate=function(F){this.navigate(F.state||window.location.href,!0)},v.prototype.click=function(F){var G=this;if(!(F.metaKey||F.ctrlKey||F.shiftKey)){for(var H=F.path?F.path[0]:F.target;H&&'A'!==H.nodeName;)H=H.parentNode;!H||'A'!==H.nodeName||G.external&&('Function'===G.external.constructor.name&&G.external(H.href)||'RegExp'===G.external.constructor.name&&G.external.test(H.href)||'String'===G.external.constructor.name&&G.external===H.href)||H.hasAttribute('download')||H.hasAttribute('external')||H.hasAttribute('target')||-1!==H.href.indexOf('mailto:')||-1!==H.href.indexOf('file:')||-1!==H.href.indexOf('tel:')||-1!==H.href.indexOf('ftp:')||(F.preventDefault(),G.navigate(H.href))}},v.prototype.start=function(){this.started||(this.view=document.querySelector(this.view),(this.container||window).addEventListener('click',this.click.bind(this)),window.addEventListener('popstate',this.popstate.bind(this)),this.navigate(window.location.href,!0))},v.prototype.scroll=function(F,G){window.scroll(F,G)},v.prototype.rendered=function(F,G){for(;this.view.lastChild;)this.view.removeChild(this.view.lastChild);F.component in this.cache||(this.cache[F.component]=document.createElement(F.component)),this.view.appendChild(this.cache[F.component]),G&&G.call(this)},v.prototype.render=function(F,G){F.title&&(document.title=F.title),F.load&&!(F.component in this.cache)?this.loader.inject(F.load,this.rendered.bind(this,F,G)):this.rendered(F,G)},v.prototype.back=function(){window.history.back()},v.prototype.redirect=function(F){window.location.href=F},v.prototype.add=function(F){'Object'===F.constructor.name?this.routes.push(F):'Array'===F.constructor.name&&(this.routes=this.routes.concat(F))},v.prototype.remove=function(F){for(var G=0,H=this.routes.length;G<H;G++)F===this.routes[G].path&&this.routes.splice(G,1)},v.prototype.get=function(F){for(var I,G=0,H=this.routes.length;G<H;G++)if(I=this.routes[G],F===I.path)return I},v.prototype.find=function(F){for(var I,G=0,H=this.routes.length;G<H;G++)if(I=this.routes[G],this.testPath(I.path,F))return I},v.prototype.toParameterObject=function(F,G){for(var H={},I=/{|}/g,J=/{(\w+)}/,K=G.split('/'),L=F.split('/'),M=0,N=L.length;M<N;M++)if(J.test(L[M])){var O=L[M].replace(I,'');H[O]=K[M]}return H},v.prototype.toQueryString=function(F){if(F){var G='?';for(var H in F)G+=H+'='+F[H]+'&';return G.slice(-1)}},v.prototype.toQueryObject=function(F){if(F){for(var K,G={},H=F.slice(1).split('&'),I=0,J=H.length;I<J;I++)K=H[I].split('='),G[K[0]]=K[1];return G}},v.prototype.getLocation=function(F){var G={};G.pathname=decodeURI(F),G.origin=window.location.origin,G.base=this.base?this.base:G.origin,'/#/'===G.base.slice(-3)&&(G.base=G.base.slice(0,-3)),'/#'===G.base.slice(-2)&&(G.base=G.base.slice(0,-2)),'/'===G.base.slice(-1)&&(G.base=G.base.slice(0,-1)),0===G.pathname.indexOf(G.base)&&(G.pathname=G.pathname.slice(G.base.length)),0===G.pathname.indexOf(G.origin)&&(G.pathname=G.pathname.slice(G.origin.length)),0===G.pathname.indexOf('/#/')&&(G.pathname=G.pathname.slice(2)),0===G.pathname.indexOf('#/')&&(G.pathname=G.pathname.slice(1));var H=this.hash?G.pathname.indexOf('#',G.pathname.indexOf('#')):G.pathname.indexOf('#');-1===H?G.hash='':(G.hash=G.pathname.slice(H),G.pathname=G.pathname.slice(0,H));var I=G.pathname.indexOf('?');return-1===I?G.search='':(G.search=G.pathname.slice(I),G.pathname=G.pathname.slice(0,I)),G.pathname=this.trailing?this.join(G.pathname,'/'):G.pathname.replace(/\/$/,''),'/'!==G.pathname.charAt(0)&&(G.pathname='/'+G.pathname),G.href=this.hash?this.joinPath(G.base,'/#/',G.pathname):this.joinPath(G.base,'/',G.pathname),G.href+=G.search,G.href+=G.hash,G},v.prototype.navigate=function(F,G){'string'==typeof F?(this.state.location=this.getLocation(F),this.state.route=this.find(this.state.location.pathname)||{},this.state.query=this.toQueryObject(this.state.location.search)||{},this.state.parameters=this.toParameterObject(this.state.route.path||'',this.state.location.pathname)||{},this.state.title=this.state.route.title||'',this.location=this.state.location):this.state=F,window.history[G?'replaceState':'pushState'](this.state,this.state.title,this.state.location.href),this.state.route.redirect?this.redirect(this.state.route.redirect):this.render(this.state.route,function(){G||this.scroll(0,0),this.emit('navigated')})},w.prototype.setup=function(F){if(this.modules={},F.modules)for(var I,G=0,H=F.modules.length;G<H;G++)I=F.modules[G],this.export.call(this,I.name,I.dependencies||I.method,I.dependencies?I.method:null)},w.prototype.load=function(F){for(var G=0,H=F.length;G<H;G++){var I=F[G],J=document.createElement('script');J.src=I,J.async=!1,J.type='text/javascript',document.head.appendChild(J)}},w.prototype.import=function(F){if(F in this.modules)return'function'==typeof this.modules[F]?this.modules[F]():this.modules[F];throw new Error('module '+F+' is not defined')},w.prototype.export=function(F,G,H){if(F in this.modules)throw new Error('module '+F+' is defined');else{if('function'==typeof G&&(H=G,G=[]),'function'==typeof H)for(var K,I=0,J=G.length;I<J;I++)K=G[I],H=H.bind(null,this.import(K));return this.modules[F]=H}},z.prototype.setup=function(F){this.request=F.request,this.response=F.response},z.prototype.mime={html:'text/html',text:'text/plain',xml:'application/xml, text/xml',json:'application/json, text/javascript',urlencoded:'application/x-www-form-urlencoded',script:'text/javascript, application/javascript, application/x-javascript'},z.prototype.serialize=function(F){var G='';for(var H in F)G=0<G.length?G+'&':G,G=G+encodeURIComponent(H)+'='+encodeURIComponent(F[H]);return G},z.prototype.fetch=function(F){var H,I,J,G=this;if(F=F?F:{},F.action=F.action?F.action:window.location.href,F.method=F.method?F.method.toUpperCase():'GET',F.headers=F.headers?F.headers:{},F.data)if('GET'===F.method)F.action=F.action+'?'+G.serialize(F.data),F.data=null;else{switch(F.requestType=F.requestType?F.requestType.toLowerCase():'',F.responseType=F.responseType?F.responseType.toLowerCase():'',F.requestType){case'script':F.contentType=G.mime.script;break;case'json':F.contentType=G.self.mime.json;break;case'xml':F.contentType=G.mime.xm;break;case'html':F.contentType=G.mime.html;break;case'text':F.contentType=G.mime.text;break;default:F.contentType=G.mime.urlencoded;}switch(F.responseType){case'script':F.accept=G.mime.script;break;case'json':F.accept=G.mime.json;break;case'xml':F.accept=G.mime.xml;break;case'html':F.accept=G.mime.html;break;case'text':F.accept=G.mime.text;}F.contentType===G.mime.json&&(F.data=JSON.stringify(F.data)),F.contentType===G.mime.urlencoded&&(F.data=G.serialize(F.data))}if(H=new XMLHttpRequest,'function'==typeof G.request&&(I=G.request(F,H)),void 0===I||!0===I){if(H.open(F.method,F.action,!0,F.username,F.password),F.mimeType&&H.overrideMimeType(F.mimeType),F.withCredentials&&(H.withCredentials=F.withCredentials),F.accept&&(F.headers.Accept=F.accept),F.contentType&&(F.headers['Content-Type']=F.contentType),F.headers)for(var K in F.headers)H.setRequestHeader(K,F.headers[K]);H.onreadystatechange=function(){if(4===H.readyState&&('function'==typeof G.response&&(J=G.response(F,H)),void 0===J||!0===J))return 200<=H.status&&400>H.status?F.success(H):F.error(H)},H.send(F.data)}},A.prototype.setup=function(F){F=('function'==typeof F?F.call(this):F)||{},F.http&&this.http.setup(F.http),F.loader&&this.loader.setup(F.loader),F.module&&this.module.setup(F.module),F.router&&this.router.setup(F.router),this.loader.start('async'),this.loader.start('defer',function(){this.router.start()}.bind(this))},A.prototype.component=function(F){return new q(F)},A.prototype.controller=function(F,G){return new p(F,G)},A.prototype.script=function(){return document._currentScript||document.currentScript},A.prototype.document=function(){return(document._currentScript||document.currentScript).ownerDocument},A.prototype.element=function(F){return(document._currentScript||document.currentScript).ownerDocument.createElement(F)},A.prototype.query=function(F){return(document._currentScript||document.currentScript).ownerDocument.querySelector(F)},A.prototype.comments=function(F){for(var H,G=[],I=new RegExp('^'+F),J=document.createNodeIterator((document._currentScript||document.currentScript).ownerDocument,NodeFilter.SHOW_COMMENT,NodeFilter.FILTER_ACCEPT);H=J.nextNode();)if(!F)G.push(H.nodeValue);else if(I.test(H.nodeValue))return H.nodeValue.replace(F,'');return G},A.prototype.escape=function(F){return F.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;')};var E=new A;return E});