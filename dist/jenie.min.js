/*
			name: jenie
		version: 1.1.1
		author: alexander elias
	*/
(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define('Jenie',b):a.Jenie=b()})(this,function(){'use strict';function a(){}function b(){}function c(){}function d(){}function f(){}function g(){}function h($){var aa=this;return aa.external=$.external,aa.routes=$.routes||[],aa.hash=null===$.hash||void 0===$.hash?!1:$.hash,aa.cache={},aa.state={},aa.base=$.base,aa.origin=window.location.origin,aa.root=$.root||''+(aa.hash?'/#/':'/'),aa.loaded=function(){aa.base||(aa.base=document.querySelector('base'),aa.base=aa.base?aa.base.getAttribute('href'):'/',aa.base=''===aa.base?'/':aa.base,aa.base='/'===aa.base[aa.base.length-1]?aa.base.slice(0,-1):aa.base),aa.view=document.querySelector('j-view')||document.querySelector('[j-view]'),aa.navigate(window.location.href,!0),window.removeEventListener('DOMContentLoaded',aa.loaded)},aa.popstate=function(ba){aa.navigate(ba.state||window.location.href,!0)},aa.click=function(ba){if(!(ba.metaKey||ba.ctrlKey||ba.shiftKey)){for(var ca=ba.path?ba.path[0]:ba.target;ca&&'A'!==ca.nodeName;)ca=ca.parentNode;if(ca&&'A'===ca.nodeName){var da=ca.getAttribute('href');if(aa.external){if('Function'===aa.external.constructor.name&&aa.external(da))return;if('RegExp'===aa.external.constructor.name&&aa.external.test(da))return;if('String'===aa.external.constructor.name&&new RegExp(aa.external).test(da))return}ca.hasAttribute('download')||ca.hasAttribute('external')||Q.has(da,'mailto:')||Q.has(da,'tel:')||Q.has(da,'file:')||Q.has(da,'ftp:')||(ba.preventDefault(),aa.navigate(da))}}},window.addEventListener('DOMContentLoaded',aa.loaded,!0),window.addEventListener('popstate',aa.popstate,!0),window.addEventListener('click',aa.click,!0),aa}function j(){}var k={GET:2,SET:3,is:function($,aa){return $&&$.constructor.name===aa},isCollection:function($){return null!==$&&'object'==typeof $},has:function($,aa){return-1!==$.indexOf(aa)},toCamelCase:function($){return'Array'===$.constructor.name&&($=$.join('-')),$.replace(/-[a-z]/g,function(aa){return aa[1].toUpperCase()})},toDashCase:function($){return'Array'===$.constructor.name&&($=$.join('')),$.replace(/[A-Z]/g,function(aa){return'-'+aa.toLowerCase()})}};a.prototype.on=function($,aa){this.events[$]||(this.events[$]=[]),this.events[$].push(aa)},a.prototype.off=function($,aa){if(this.events[$]){var ba=this.events[$].indexOf(aa);-1<this.events[$].indexOf(aa)&&this.events[$].splice(ba,1)}},a.prototype.emit=function($){if(this.events[$])for(var aa=[].slice.call(arguments,1),ba=this.events[$].slice(),ca=0,da=ba.length;ca<da;ca++)ba[ca].apply(this,aa)};var n=k;b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.join=function(){return Array.prototype.join.call(arguments,'.').replace(/\.{2,}/g,'.').replace(/^\.|\.$/g,'')},b.prototype.each=function($,aa,ba){Object.keys($).slice(ba).forEach(function(ca){aa.call(this,$[ca],ca,$)},this)},b.prototype.every=function($,aa,ba,ca,da){n.isCollection($)&&this.each($,function(ea,fa){this.every(ea,aa,0,!0,this.join(da,fa))},ba),ca&&aa.call(this,$,da||'')},b.prototype.get=function($){for(var aa=$.split('.'),ba=aa.length-1,ca=this.data,da=0;da<ba;da++){if(!ca[aa[da]])return;ca=ca[aa[da]]}return ca[aa[ba]]},b.prototype.set=function($,aa){for(var fa,ba=$.split('.'),ca=ba.length-1,da=this.data,ea=0;ea<ca;ea++)fa=ba[ea],void 0===da[fa]&&(da[fa]={}),da=da[fa];return da[ba[ca]]=aa},b.prototype.ins=function($,aa,ba){$._meta[aa]=ba,this.define(ba,this.join($._path,aa),!0),this.defineProperty($,aa),this.emit('*',this.join($._path,aa),ba),this.emit('*',this.join($._path),$)},b.prototype.del=function($,aa){if(n.is($,'Object')){var ba=$[aa];delete $._meta[aa],delete $[aa],this.every(ba,function(ca,da){da=this.join($._path,aa,da),this.emit('*',da,void 0)}),this.emit('*',this.join($._path,aa),void 0)}else n.is($,'Array')&&($._meta.splice(aa,1),$.splice($.length-1,1),this.every($,function(ca,da){da=this.join($._path,da),n.isCollection(ca)&&(ca._path=da),this.emit('*',da,ca)},parseInt(aa)),this.emit('*',this.join($._path,$.length),void 0),this.emit('*',this.join($._path),$))},b.prototype.defineProperty=function($,aa){Object.defineProperty($,aa,{enumerable:!0,configurable:!0,get:function(){return this._meta[aa]},set:function(ba){ba===void 0?this.del(aa):this.ins(aa,ba)}})},b.prototype.define=function($,aa,ba){if(n.isCollection($)){var ca=this;Object.defineProperties($,{_meta:{writable:!0,configurable:!0,value:$.constructor()},_path:{writable:!0,configurable:!0,value:aa||''},ins:{value:ca.ins.bind(ca,$)},del:{value:ca.del.bind(ca,$)}}),Object.keys($).forEach(function(da){void 0===$[da]||($._meta[da]=$[da],this.define($[da],this.join(aa||'',da),ba),this.defineProperty($,da),ba&&this.emit('*',this.join(aa||'',da),$[da]))},this)}},b.prototype.setup=function($){return this.data=$,this.define(this.data,null,!0),this},b.prototype.create=function(){return this.events={},this};var q=k,t={sViewElement:'j-view',sPrefix:'(data-)?j-',sValue:'(data-)?j-value',sFor:'(data-)?j-for-(.*?)=',sAccepts:'(data-)?j-',sRejects:'^w+(-w+)+|^iframe|^object|^script',rPath:/\s?\|(.*?)$/,rPrefix:/(data-)?j-/,rValue:/(data-)?j-value/,rModifier:/^(.*?)\|\s?/,rFor:/(data-)?j-for-(.*?)=/,rAccepts:/(data-)?j-/,rRejects:/^\w+(-\w+)+|^iframe|^object|^script/,rAttributeAccepts:/(data-)?j-/,rElementAccepts:/(data-)?j-/,rElementRejectsChildren:/(data-)?j-each/,rElementRejects:/^\w+(-\w+)+|^iframe|^object|^script/};c.prototype.unrender=function(){return this},c.prototype.render=function(){return this.method(),this},c.prototype.create=function($){return this.view=$.view,this.element=$.element,this.attribute=$.attribute,this.method=$.method.bind(this),Object.defineProperty(this,'data',{enumerable:!0,configurable:!0,get:$.getter,set:$.setter}),this};var v={on:function(){var $=this.attribute.cmds[1];this.element.removeEventListener($,this.data,!1),this.element.addEventListener($,this.data,!1)},each:function(){this.length===void 0?(this.length=this.data.length,this.variable=this.attribute.cmds.slice(1).join('.'),this.clone=this.element.removeChild(this.element.children[0]).outerHTML,this.pattern=new RegExp('(((data-)?j(-(\\w)+)+="))'+this.variable+'(((\\.(\\w)+)+)?((\\s+)?\\|((\\s+)?(\\w)+)+)?(\\s+)?")','g'),this.data.forEach(function($,aa){this.element.insertAdjacentHTML('beforeend',this.clone.replace(this.pattern,'$1'+this.attribute.path+'.'+aa+'$6'))},this),this.view.add(this.element.getElementsByTagName('*'),!0)):this.length>this.data.length?(this.length--,this.element.removeChild(this.element.lastChild)):this.length<this.data.length&&(this.length++,this.element.insertAdjacentHTML('beforeend',this.clone.replace(this.pattern,'$1'+this.attribute.path+'.'+(this.length-1)+'$6')),this.view.addOne(this.element.lastChild,!0),this.view.add(this.element.lastChild.getElementsByTagName('*'),!0))},value:function(){return this.change?void 0:'button'===this.element.type||'reset'===this.element.type?this.change=!0:void(this.change=function(){this.data='radio'!==this.element.type&&'checked'!==this.element.type?this.element.value:this.element.checked},this.element.addEventListener('change',this.change.bind(this),!0),this.element.addEventListener('keyup',this.change.bind(this),!0))},html:function(){this.element.innerHTML=this.data,this.view.add(this.element.getElementsByTagName('*'),!0)},css:function(){var $=this.data;1<this.attribute.cmds.length&&($=this.attribute.cmds.slice(1).join('-')+': '+$+';'),this.element.style.cssText+=$},class:function(){var $=this.attribute.cmds.slice(1).join('-');this.element.classList.toggle($,this.data)},text:function(){this.element.innerText=this.data},enable:function(){this.element.disabled=!this.data},disable:function(){this.element.disabled=this.data},show:function(){this.element.hidden=!this.data},hide:function(){this.element.hidden=this.data},write:function(){this.element.readOnly=!this.data},read:function(){this.element.readOnly=this.data},selected:function(){this.element.selectedIndex=this.data},default:function(){var $=q.toCamelCase(this.attribute.cmds);q.setByPath(this.element,$,this.data)}},w=t,z=function($){return new c().create($)},A=w.rPath,B=w.rPrefix,C=w.rModifier,D=w.rAttributeAccepts,E=w.rElementAccepts,F=w.rElementRejects,G=w.rElementRejectsChildren;d.prototype.glance=function($){return $.outerHTML.replace(/\/?>([\s\S])*/,'').replace(/^</,'')},d.prototype.eachElement=function($,aa){for(var ba,ca,da=0;da<$.length;da++)ba=$[da],ca=this.glance(ba),F.test(ca)?da+=ba.querySelectorAll('*').length:G.test(ca)?(da+=ba.querySelectorAll('*').length,aa(ba)):E.test(ca)&&aa(ba)},d.prototype.eachAttribute=function($,aa){for(var ca,ba=$.attributes,da=0;da<ba.length;da++)ca={},ca.name=ba[da].name,ca.value=ba[da].value,D.test(ca.name)&&(ca.path=ca.value.replace(A,''),ca.opts=ca.path.split('.'),ca.command=ca.name.replace(B,''),ca.cmds=ca.command.split('-'),ca.modifiers=-1===ca.value.indexOf('|')?[]:ca.value.replace(C,'').split(' '),aa(ca))},d.prototype.removeAll=function($){$='string'==typeof $?new RegExp($):$,Object.keys(this.data).forEach(function(aa){this.data[aa].forEach(function(ba,ca){$.test(aa+'.'+ca)&&(this.data[aa][ca].unrender(),this.data[aa].splice(ca,1))},this)},this)},d.prototype.renderAll=function($){(this.data[$]||[]).forEach(function(aa){aa.render()},this)},d.prototype.addOne=function($,aa){var ca,ba=this;return ba.eachAttribute($,function(da){da.path in ba.data||(ba.data[da.path]=[]),ca=z({view:ba,element:$,attribute:da,method:v[da.cmds[0]]||v['default'],getter:ba.getter,setter:ba.setter}),aa&&ca.render(),ba.data[da.path].push(ca)}),ba},d.prototype.add=function($,aa){var ca,ba=this;return ba.eachElement($,function(da){ba.eachAttribute(da,function(ea){ea.path in ba.data||(ba.data[ea.path]=[]),ca=z({view:ba,element:da,attribute:ea,method:v[ea.cmds[0]]||v['default'],getter:ba.getter,setter:ba.setter}),aa&&ca.render(),ba.data[ea.path].push(ca)})}),ba},d.prototype.setup=function($){return this.setter=$.setter,this.getter=$.getter,this.data={},this.add($.elements),self},d.prototype.create=function(){return this};var I=function($){return new b().create($)},J=function(){return new d().create()};f.prototype.setup=function($){var aa=this;return Object.defineProperties(aa,{name:{value:$.name},modifiers:{value:$.modifiers||{}},_view:{value:J()},_model:{value:I()},view:{enumerable:!0,get:function(){return aa._view.data}},model:{enumerable:!0,get:function(){return aa._model.data}},elements:{get:function(){return($.view.shadowRoot||$.view).querySelectorAll('*')}}}),aa._model.on('*',function(ba,ca){void 0===ca?aa._view.removeAll('^'+ba+'.*'):aa._view.renderAll(ba)}),aa._view.setup({elements:($.view.shadowRoot||$.view).querySelectorAll('*'),getter:function(){return this._data=aa._model.get(this.attribute.path),this.attribute.modifiers.forEach(function(ba){this._data=aa.modifiers[ba].call(this._data)},this),this._data},setter:function(ba){this._data=aa._model.set(this.attribute.path,ba)}}),aa._model.setup($.model||{}),aa},f.prototype.create=function($,aa){var ba=this;if($.model&&'function'==typeof $.model)$.model.call(ba,function(ca){if($.model=ca,ba.setup($),aa)return aa.call(ba)});else if(ba.setup($),aa)return aa.call(ba);return ba};var K=function($,aa){return new f().create($,aa)},L='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split(''),O=function(){var aa=[],ba;aa[8]=aa[13]=aa[18]=aa[23]='-',aa[14]='4';for(var ca=0;36>ca;ca++)aa[ca]||(ba=0|16*Math.random(),aa[ca]=L[19==ca?8|3&ba:ba]);return aa.join('')};g.prototype.comment=function($){if('function'!=typeof $)throw new Error('Comment must be a function');var aa=/\/\*!?(?:\@preserve)?[ \t]*(?:\r\n|\n)([\s\S]*?)(?:\r\n|\n)\s*\*\//,ba=aa.exec($.toString());if(!ba)throw new Error('Comment missing');return ba[1]},g.prototype.dom=function($){var aa=document.createElement('div');return aa.innerHTML=$,aa.children[0]},g.prototype._template=function($){return'Function'===$.constructor.name?($=this.comment($),$=this.dom($)):'String'===$.constructor.name&&(/<|>/.test($)?$=this.dom($):$=this.currentScript.ownerDocument.querySelector($)),$},g.prototype.define=function($,aa){return document.registerElement($,{prototype:Object.create(HTMLElement.prototype,aa)})},g.prototype.create=function($){if(!$)throw new Error('missing options');if(!$.name)throw new Error('missing options.name');if(!$.template)throw new Error('missing options.template');var aa=this;return aa.name=$.name,aa.model=$.model,aa.modifiers=$.modifiers,aa.currentScript=document._currentScript||document.currentScript,aa.template=aa._template($.template),$.created&&(aa.created=$.created.bind(aa)),$.attached&&(aa.attached=$.attached.bind(aa)),$.detached&&(aa.detached=$.detached.bind(aa)),$.attributed&&(aa.attributed=$.attributed.bind(aa)),aa.proto=aa.define(aa.name,{attachedCallback:{value:aa.attached},detachedCallback:{value:aa.detached},attributeChangedCallback:{value:aa.attributed},createdCallback:{value:function(){aa.element=this,aa.uuid=O(),aa.element.appendChild(document.importNode(aa.template.content,!0)),aa.model?aa.binder=K({name:aa.uuid,model:aa.model,view:aa.element,modifiers:aa.modifiers},function(){aa.model=this.model,aa.created&&aa.created.call(aa)}):aa.created&&aa.created.call(aa)}}}),aa};var Q=k;h.prototype.scroll=function($,aa){return window.scroll($,aa),this},h.prototype.normalize=function($){return $=decodeURI($).replace(/\/{2,}/g,'/').replace(/(http(s)?:\/)/,'$1/').replace(/\?.*/,''),$=''===$?'/':$},h.prototype.join=function(){return this.normalize(Array.prototype.join.call(arguments,'/'))},h.prototype.url=function($){var aa={};return aa.root=this.root,aa.origin=this.origin,aa.base=this.normalize(this.base),aa.path=$,aa.path=0===aa.path.indexOf(aa.origin)?aa.path.replace(aa.origin,''):aa.path,aa.path='/'===aa.base?aa.path:aa.path.replace(aa.base,''),aa.path=0===aa.path.indexOf(aa.root)?aa.path.replace(aa.root,'/'):aa.path,aa.path=this.normalize(aa.path),aa.path='/'===aa.path[0]?aa.path:'/'+aa.path,aa.href=this.join(aa.origin,aa.base,aa.root,aa.path),aa},h.prototype.render=function($){var aa=this.cache[$.component];return $.title&&(document.title=$.title),!0===$.cache||void 0===$.cache?(aa=this.cache[$.component],!aa&&(aa=this.cache[$.component]=document.createElement($.component))):aa=document.createElement($.component),this.view.firstChild&&this.view.removeChild(this.view.firstChild),this.view.appendChild(aa),this},h.prototype.add=function($){return'Object'===$.constructor.name?this.routes.push($):'Array'===$.constructor.name&&(this.routes=this.routes.concat($)),this},h.prototype.remove=function($){for(var aa=0,ba=this.routes.length;aa<ba;aa++)if($===this.routes[aa].path){this.routes.splice(aa,1);break}return this},h.prototype.redirect=function($){return window.location.href=$,this},h.prototype.get=function($){for(var aa,ba=0,ca=this.routes.length;ba<ca;ba++)if(aa=this.routes[ba],'string'==typeof aa.path){if(aa.path===$)return aa;}else if('function'==typeof aa.path&&aa.path.test($))return aa;throw new Error('could not find '+$+' in routes')},h.prototype.navigate=function($,aa){return'string'==typeof $?(this.state.url=this.url($),this.state.route=this.get(this.state.url.path),this.state.title=this.state.route.title):this.state=$,window.history.state&&(window.history.state.scroll={x:window.pageXOffset,y:window.pageYOffset},window.history.replaceState(window.history.state,window.history.state.title,window.history.state.url.href)),window.history[aa?'replaceState':'pushState'](this.state,this.state.route.title,this.state.url.href),this.state.route.redirect?this.redirect(this.state.route):this.render(this.state.route),window.history.state&&window.history.state.scroll&&(0!==window.history.state.scroll.x||0!==window.history.state.scroll.y)&&this.scroll(window.history.state.scroll.x,window.history.state.scroll.y),this};j.prototype.mime={html:'text/html',text:'text/plain',xml:'application/xml, text/xml',json:'application/json, text/javascript',urlencoded:'application/x-www-form-urlencoded',script:'text/javascript, application/javascript, application/x-javascript'},j.prototype.serialize=function($){var aa='';for(var ba in $)aa=0<aa.length?aa+'&':aa,aa=aa+encodeURIComponent(ba)+'='+encodeURIComponent($[ba]);return aa},j.prototype.fetch=function($){var aa=this;if(!$)throw new Error('fetch: requires options');if(!$.action)throw new Error('fetch: requires options.action');if($.method||($.method='GET'),$.headers||($.headers={}),$.data)if('GET'===$.method)$.action=$.action+'?'+aa.serialize($.data),$.data=null;else{switch($.requestType=$.requestType?$.requestType.toLowerCase():'',$.responseType=$.responseType?$.responseType.toLowerCase():'',$.requestType){case'script':$.contentType=aa.mime.script;break;case'json':$.contentType=aa.self.mime.json;break;case'xml':$.contentType=aa.mime.xm;break;case'html':$.contentType=aa.mime.html;break;case'text':$.contentType=aa.mime.text;break;default:$.contentType=aa.mime.urlencoded;}switch($.responseType){case'script':$.accept=aa.mime.script;break;case'json':$.accept=aa.mime.json;break;case'xml':$.accept=aa.mime.xml;break;case'html':$.accept=aa.mime.html;break;case'text':$.accept=aa.mime.text;}$.contentType===aa.mime.json&&($.data=JSON.stringify($.data)),$.contentType===aa.mime.urlencoded&&($.data=aa.serialize($.data))}var ba=new XMLHttpRequest;if(ba.open($.method.toUpperCase(),$.action,!0,$.username,$.password),$.mimeType&&ba.overrideMimeType($.mimeType),$.withCredentials&&(ba.withCredentials=$.withCredentials),$.accept&&($.headers.Accept=$.accept),$.contentType&&($.headers['Content-Type']=$.contentType),$.headers)for(var ca in $.headers)ba.setRequestHeader(ca,$.headers[ca]);ba.onreadystatechange=function(){if(4===ba.readyState)return 200<=ba.status&&400>ba.status?$.success(ba):$.error(ba)},ba.send($.data)},j.prototype.create=function(){var $=this;return $};var T=function($){return new g().create($)},W=function($){return new h($)},Y=t.sViewElement;document.registerElement(Y,{prototype:Object.create(HTMLElement.prototype)});var Z={services:{},http:function(){return new j().create()}(),component:function($){return T($)},binder:function($,aa){return K($,aa)},router:function($){return this.router=W($)},query:function($){return(document._currentScript||document.currentScript).ownerDocument.querySelector($)},script:function(){return document._currentScript||document.currentScript},document:function(){return(document._currentScript||document.currentScript).ownerDocument}};return Z});