/*
	name: jenie
	version: 1.0.5
	author: alexander elias
*/
(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define('Jenie',b):a.Jenie=b()})(this,function(){'use strict';function a(){}function b(){}function c(){}function d(){}function f(){}function g(){}function h(){}var j={sViewElement:'j-view',sPrefix:'(data-)?j-',sValue:'(data-)?j-value',sFor:'(data-)?j-for-(.*?)=',sAccepts:'(data-)?j-',sRejects:'^w+(-w+)+|^iframe|^object|^script',rPath:/\s?\|(.*?)$/,rPrefix:/(data-)?j-/,rValue:/(data-)?j-value/,rModifier:/^(.*?)\|\s?/,rFor:/(data-)?j-for-(.*?)=/,rAccepts:/(data-)?j-/,rRejects:/^\w+(-\w+)+|^iframe|^object|^script/,rAttributeAccepts:/(data-)?j-/,rElementAccepts:/(data-)?j-/,rElementRejects:/^\w+(-\w+)+|^iframe|^object|^script/};a.prototype.ins=function(S,T,U,V,W){('Object'===W.constructor.name||'Array'===W.constructor.name)&&(W=this.create(W,T,U+V,!0)),'Array'===S.constructor.name&&-1==V&&(V=0,S.splice(V,0,W),S=Object.defineProperty(S,V,this.descriptor(U+V,W,T)),V=S.length-1,W=S[V]),S=Object.defineProperty(S,V,this.descriptor(U+V,W,T)),T&&T(U+V,W)},a.prototype.del=function(S,T,U,V){if('Object'===S.constructor.name)delete S[V];else if('Array'===S.constructor.name){var W=S.length-1;S.splice(V,1),V=W}T&&T(U+V,void 0)},a.prototype.descriptor=function(S,T,U){return{configurable:!0,enumerable:!0,get:function(){return T},set:function(V){T=V,U(S,T)}}},a.prototype.create=function(S,T,U){var W,X,Y,V=this;for(X in U=U?U+='.':'',W='Object'===S.constructor.name?{}:[],W=Object.defineProperty(W,'ins',{value:V.ins.bind(V,W,T,U)}),W=Object.defineProperty(W,'del',{value:V.del.bind(V,W,T,U)}),S)Y=S[X],('Object'===Y.constructor.name||'Array'===Y.constructor.name)&&(Y=V.create(Y,T,U+X)),W=Object.defineProperty(W,X,V.descriptor(U+X,Y,T)),T&&T(U+X,Y);return W};var m=j,n=m.rPath,o=m.rPrefix,p=m.rAttributeAccepts,q=m.rElementAccepts,s=m.rElementRejects;b.prototype.glance=function(S){return S.outerHTML.replace(/(\/)?>.*$/,'').replace(/^</,'')},b.prototype.eachElement=function(S,T){var U,V,W;for(W=0;W<S.length;W++)U=S[W],V=this.glance(U),s.test(V)?W+=U.children.length:q.test(V)&&T(U)},b.prototype.eachAttribute=function(S,T){var V,U={};for(V=0;V<S.attributes.length;V++)U.name=S.attributes[V].name,U.value=S.attributes[V].value,U.path=U.value.replace(n,''),U.opts=U.path.split('.'),U.command=U.name.replace(o,''),U.cmds=U.command.split('-'),p.test(U.name)&&T(U)},b.prototype.create=function(S,T){var U=this,V={};return U.eachElement(S,function(W){U.eachAttribute(W,function(X){X.path in V||(V[X.path]=[]),V[X.path].push(T(W,X))})}),V};var v={GET:2,SET:3,toCamelCase:function(S){return'Array'===S.constructor.name&&(S=S.join('-')),S.replace(/-[a-z]/g,function(T){return T[1].toUpperCase()})},toDashCase:function(S){return'Array'===S.constructor.name&&(S=S.join('')),S.replace(/[A-Z]/g,function(T){return'-'+T.toLowerCase()})},interact:function(S,T,U,V){for(var $,W=U.split('.'),X=W.length-1,Y=T,Z=0;Z<X;Z++){if($=W[Z],null===Y[$]||void 0===Y[$]){if(S===this.GET)return;S===this.SET&&(Y[$]={})}Y=Y[$]}if(S===this.GET)return Y[W[X]];return S===this.SET?(Y[W[X]]=V,T):void 0},getByPath:function(S,T){return this.interact(this.GET,S,T)},setByPath:function(S,T,U){return this.interact(this.SET,S,T,U)}};c.prototype.attributes={on:function(){var S=this;if('function'==typeof S.value){var T=S.attribute.cmds[1],U=S.attribute.opts[S.attribute.opts.length-1];S.element.removeEventListener(T,S.listeners[U],!1),S.listeners[U]=function(V){V.preventDefault(),S.value.call(S,V)},S.element.addEventListener(T,S.listeners[U],!1)}},each:function(){var S=this;S.clone||(S.clone=S.element.children[0]);var T=S.attribute.cmds.slice(1),U=S.clone.cloneNode(!0),V='';U=U.outerHTML,T=v.toCamelCase(T),T=new RegExp('="'+T,'g');for(var W=0,X=S.value.length;W<X;W++)V+=U.replace(T,'="'+S.attribute.value+'.'+W.toString());S.element.innerHTML=V;var Y=S.controller.createView(S.element.getElementsByTagName('*'));for(var Z in Y)S.view[Z].render(),S.controller.view[Z].concat(S.view[Z])},value:function(){var S=this;if(('checkbox'===S.element.type||'radio'===S.element.type)&&(S.element.value=S.value,S.element.checked=S.value),!S.isChangeEventAdded){S.isChangeEventAdded=!0;var T=function(U){if(!S.isChanging){S.isChanging=!0;var V=U.target,W='checkbox'===V.type||'radio'===V.type?V.checked:V.value;v.setByPath(S.controller.model,S.attribute.opts[0],W),S.isChanging=!1}};S.element.addEventListener('change',T),S.element.addEventListener('keyup',T)}},html:function(){this.element.innerHTML=this.value,this.controller.insert(this.element.getElementsByTagName('*'))},css:function(){1<this.attribute.cmds.length&&(this.value=this.attribute.cmds.slice(1).join('-')+': '+this.value+';'),this.element.style.cssText+=this.value},class:function(){var S=this.attribute.cmds.slice(1).join('-');this.element.classList.toggle(S,this.value)},text:function(){this.element.innerText=this.value},enable:function(){this.element.disabled=!this.value},disable:function(){this.element.disabled=this.value},show:function(){this.element.hidden=!this.value},hide:function(){this.element.hidden=this.value},write:function(){this.element.readOnly=!this.value},read:function(){this.element.readOnly=this.value},selected:function(){this.element.selectedIndex=this.value},default:function(){var S=v.toCamelCase(this.attribute.cmds);v.setByPath(this.element,S,this.value)}},c.prototype.create=function(S){var T=this;return T.isChangeEventAdded=!1,T.controller=S.controller,T.attribute=S.attribute,T.modifiers=S.modifiers,T.element=S.element,T.isChanging=!1,T.listeners={},T.clone,T._value=null,Object.defineProperty(T,'value',{configurable:!0,enumerable:!0,get:function(){return T.modifiers.forEach(function(U){T._value=U.call(T._value)}),T._value},set:function(U){T._value=U}}),T.render=T.attribute.cmds[0]in T.attributes?T.attributes[T.attribute.cmds[0]]:T.attributes.default,T};var y=function(S,T){return new a().create(S,T)},z=function(S,T){return new b().create(S,T)},A=function(S){return new c().create(S)};d.prototype.parseModifiers=function(S){var T=this;if(-1===S.indexOf('|'))return[];var U=S.replace(j.rModifier,'').split(' ');return U.map(function(V){return T.modifiers[V]})},d.prototype.createView=function(S){var T=this;return z(S,function(U,V){return A({controller:T,element:U,attribute:V,modifiers:T.parseModifiers(V.value)})})},d.prototype.createModel=function(S){var T=this;return y(S,function(U,V){T.view[U].forEach(function(W){W.value=V,W.render()})})},d.prototype.create=function(S,T){var U=this;return U.name=S.name,U.scope=S.scope.shadowRoot||S.scope,U.model=S.model||{},U.modifiers=S.modifiers||{},U.view=S.view||U.scope.querySelectorAll('*'),U.view=U.createView(U.view),U.model=U.createModel(U.model),T&&T.call(U),U};var B=function(S,T){return new d().create(S,T)},C='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split(''),F=function(){var T=[],U;T[8]=T[13]=T[18]=T[23]='-',T[14]='4';for(var V=0;36>V;V++)T[V]||(U=0|16*Math.random(),T[V]=C[19==V?8|3&U:U]);return T.join('')};f.prototype.comment=function(S){if('function'!=typeof S)throw new Error('Comment must be a function');var T=/\/\*!?(?:\@preserve)?[ \t]*(?:\r\n|\n)([\s\S]*?)(?:\r\n|\n)\s*\*\//,U=T.exec(S.toString());if(!U)throw new Error('Comment missing');return U[1]},f.prototype.dom=function(S){var T=document.createElement('div');return T.innerHTML=S,T.children[0]},f.prototype._template=function(S){return'Function'===S.constructor.name?(S=this.comment(S),S=this.dom(S)):'String'===S.constructor.name&&(/<|>/.test(S)?S=this.dom(S):S=this.currentScript.ownerDocument.querySelector(S)),S},f.prototype.define=function(S){var T,U;for(T in S)'name'===T?(U=S.name,delete S.name):S[T]={value:S[T]};return document.registerElement(U,{prototype:Object.create(HTMLElement.prototype,S)})},f.prototype.create=function(S){if(!S)throw new Error('missing options');if(!S.name)throw new Error('missing options.name');if(!S.template)throw new Error('missing options.template');var T=this;return T.name=S.name,T.model=S.model,T.services=S.services,T.modifiers=S.modifiers,T.controller=S.controller,T.currentScript=document._currentScript||document.currentScript,T.template=T._template(S.template),S.created&&(T.created=S.created.bind(T)),S.attached&&(T.attached=S.attached.bind(T)),S.detached&&(T.detached=S.detached.bind(T)),S.attributed&&(T.attributed=S.attributed.bind(T)),T.proto=T.define({name:T.name,attachedCallback:T.attached,detachedCallback:T.detached,attributeChangedCallback:T.attributed,createdCallback:function(){T.element=this,T.uuid=F(),T.element.appendChild(document.importNode(T.template.content,!0)),T.binder=B({name:T.uuid,scope:T.element,model:T.model,modifiers:T.modifiers},T.controller),T.model=T.binder.model,T.created&&T.created.call(T)}}),T};var I={has:function(S,T){return-1!==S.indexOf(T)},normalize:function(S){return S=decodeURI(S).replace(/\/{2,}/g,'/').replace(/\?.*/,'').replace(/\/$/,''),''===S?'/':S},getHash:function(S){return this.normalize(S.split('?')[0].split('#')[1]||'')},getSearch:function(S){return this.normalize(S.split('?')[1]||'')},getPath:function(S,T,U){return this.normalize(S.replace(window.location.origin,'/').replace(T,'/').replace(U,'/'))}};g.prototype.render=function(S){var T=this,U=null;S.title&&(document.title=S.title),U='string'==typeof S.component?S.component in T.components?T.components[S.component]:T.components[S.component]=document.createElement(S.component):S.component,T.view.firstChild&&T.view.removeChild(T.view.firstChild),T.view.appendChild(U),window.scroll(0,0)},g.prototype.redirect=function(S){var T=this;return window.location=S.path,T},g.prototype.add=function(S){var T=this;return'Object'===S.constructor.name?T.routes.push(S):'Array'===S.constructor.name&&(T.routes=T.routes.concat(S)),T},g.prototype.remove=function(S){for(var W,T=this,U=0,V=T.routes.length;U<V;U++)if(W=T.routes[U],S===W.path){T.routes.splice(U,1);break}return T},g.prototype.get=function(S){var T=this,U=0,V=null,W=T.routes.length;for(U;U<W;U++)if(V=T.routes[U],!V.path)throw new Error('Router: missing path option');else if('string'==typeof V.path){if(V.path===S||V.path==='/'+S)return V;}else if('function'==typeof V.path&&V.path.test(S))return V;return V={},V.title='404',V.component=document.createElement('div'),V.component.innerHTML='{ "statusCode": 404, "error": "Not Found" }',V},g.prototype.change=function(S,T){var U=this;return U.mode?window.history[T?'replaceState':'pushState'](S,S.title,I.normalize(S.origin+S.path)):(U.isChangeEvent=!1,window.location=I.normalize(S.origin+S.path)),U},g.prototype.navigate=function(S,T){var U=this;return U.state.path=I.getPath(S.path,U.state.base,U.state.root),U.state.hash=I.getHash(U.state.path),U.state.search=I.getSearch(U.state.path),U.state.href=I.normalize(window.location.href),U.route=U.get(U.state.path),U.state.title=U.route.title,U.change(U.state,T),U.route.redirect?U.redirect(U.route):U.render(U.route),U},g.prototype.create=function(S){var T=this;return T.components={},T.routes=S.routes||[],T.redirects=S.redirects||[],T.mode=S.mode,T.mode=null===T.mode||void 0===T.mode||T.mode,T.mode='history'in window&&'pushState'in window.history&&T.mode,T.isChangeEvent=!0,T.base=S.base||'',T.external=S.external||'',T.root=S.root||(T.mode?'/':'/#'),T.state={root:T.root,base:T.base,origin:I.normalize(T.base+T.root)},window.addEventListener('DOMContentLoaded',function(){T.view=document.querySelector('j-view')||document.querySelector('[j-view]'),T.navigate({path:window.location.href},!0)},!1),window.addEventListener(T.mode?'popstate':'hashchange',function(U){if(T.isChangeEvent){var V=T.mode?U.state:{path:U.newURL};T.navigate(V,!0)}else T.isChangeEvent=!0},!1),window.addEventListener('click',function(U){if(!(U.metaKey||U.ctrlKey||U.shiftKey)){for(var V=U.path?U.path[0]:U.target;V&&'A'!==V.nodeName;)V=V.parentNode;!V||'A'!==V.nodeName||T.external&&0!==I.path(V.href,T.state.base,T.state.root).indexOf(T.external)||V.hasAttribute('download')||'external'===V.getAttribute('rel')||I.has(V.href,'mailto:')||I.has(V.href,'tel:')||I.has(V.href,'file:')||I.has(V.href,'ftp:')||(U.preventDefault(),T.navigate({path:V.href}))}},!1),T};h.prototype.mime={html:'text/html',text:'text/plain',xml:'application/xml, text/xml',json:'application/json, text/javascript',urlencoded:'application/x-www-form-urlencoded',script:'text/javascript, application/javascript, application/x-javascript'},h.prototype.serialize=function(S){var T='';for(var U in S)T=0<T.length?T+'&':T,T=T+encodeURIComponent(U)+'='+encodeURIComponent(S[U]);return T},h.prototype.fetch=function(S){var T=this;if(!S)throw new Error('fetch: requires options');if(!S.action)throw new Error('fetch: requires options.action');if(S.method||(S.method='GET'),S.headers||(S.headers={}),S.data)if('GET'===S.method)S.action=S.action+'?'+T.serialize(S.data),S.data=null;else{switch(S.requestType=S.requestType?S.requestType.toLowerCase():'',S.responseType=S.responseType?S.responseType.toLowerCase():'',S.requestType){case'script':S.contentType=T.mime.script;break;case'json':S.contentType=T.self.mime.json;break;case'xml':S.contentType=T.mime.xm;break;case'html':S.contentType=T.mime.html;break;case'text':S.contentType=T.mime.text;break;default:S.contentType=T.mime.urlencoded;}switch(S.responseType){case'script':S.accept=T.mime.script;break;case'json':S.accept=T.mime.json;break;case'xml':S.accept=T.mime.xml;break;case'html':S.accept=T.mime.html;break;case'text':S.accept=T.mime.text;}S.contentType===T.mime.json&&(S.data=JSON.stringify(S.data)),S.contentType===T.mime.urlencoded&&(S.data=T.serialize(S.data))}var U=new XMLHttpRequest;if(U.open(S.method.toUpperCase(),S.action,!0,S.username,S.password),S.mimeType&&U.overrideMimeType(S.mimeType),S.withCredentials&&(U.withCredentials=S.withCredentials),S.accept&&(S.headers.Accept=S.accept),S.contentType&&(S.headers['Content-Type']=S.contentType),S.headers)for(var V in S.headers)U.setRequestHeader(V,S.headers[V]);U.onreadystatechange=function(){if(4===U.readyState)return 200<=U.status&&400>U.status?S.success(U):S.error(U)},U.send(S.data)},h.prototype.create=function(){var S=this;return S};var L=function(S){return new f().create(S)},O=function(S){return new g().create(S)},P=function(){return new h().create()},Q=j.sViewElement;document.registerElement(Q,{prototype:Object.create(HTMLElement.prototype)});return{services:{},component:function(S){return L(S)},router:function(S){return this.router=O(S)},binder:function(S,T){return B(S,T)},http:function(){return this.http=P()},query:function(S){return(document._currentScript||document.currentScript).ownerDocument.querySelector(S)},script:function(){return document._currentScript||document.currentScript},document:function(){return(document._currentScript||document.currentScript).ownerDocument}}});
