/*
	@preserve
	name: jenie
	version: 1.0.3
	author: alexander elias
*/
(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define('Jenie',b):a.Jenie=b()})(this,function(){'use strict';function a(T,U){this.isChangeEventAdded=!1,this.controller=U,this.isChanging=!1,this.element=T,this.listeners={},this.clone}function b(){}function d(T,U){this.name=T.name,this.scope=T.scope,this.view=T.view||{},this.model=T.model||{},this.doc=T.doc||document,this.prefix=T.prefix||'j',this.modifiers=T.modifiers||{},this.sPrefix=this.prefix+'-',this.sValue=this.prefix+'-value',this.sFor=this.prefix+'-for-(.*?)="',this.sAccepts=this.prefix+'-(.*?)="',this.sRejects=this.prefix+'-controller=|<w+-w+|iframe|object|script',this.query='['+this.prefix+'-controller='+this.name+']',this.rPath=/(\s)?\|(.*?)$/,this.rModifier=/^(.*?)\|(\s)?/,this.rFor=new RegExp(this.sFor),this.rPrefix=new RegExp(this.sPrefix),this.rAccepts=new RegExp(this.sAccepts),this.rRejects=new RegExp(this.sRejects),U&&U.call(this)}function f(T){var U='';for(var V in T)U=0<U.length?U+'&':U,U=U+encodeURIComponent(V)+'='+encodeURIComponent(T[V]);return U}function h(T,U){C.fetch({action:T,success:function(V){return U(V.response)},error:function(V){throw new Error('getTemplateUrl: '+V.status+' '+V.statusText)}})}function j(T){var U=/\/\*!?(?:\@preserve)?[ \t]*(?:\r\n|\n)([\s\S]*?)(?:\r\n|\n)\s*\*\//;if('function'!=typeof T)throw new TypeError('Multiline function missing');var V=U.exec(T.toString());if(!V)throw new TypeError('Multiline comment missing');return V[1]}function m(T){'function'==typeof T&&(T=j(T));var U=document.createElement('container');return U.innerHTML=T,U.children[0]}var n={GET:2,SET:3,toCamelCase:function(T){return'Array'===T.constructor.name&&(T=T.join('-')),T.replace(/-[a-z]/g,function(U){return U[1].toUpperCase()})},toDashCase:function(T){return'Array'===T.constructor.name&&(T=T.join('')),T.replace(/[A-Z]/g,function(U){return'-'+U.toLowerCase()})},interact:function(T,U,V,W){for(var _,X=V.split('.'),Y=X.length-1,Z=U,$=0;$<Y;$++){if(_=X[$],null===Z[_]||void 0===Z[_]){if(T===this.GET)return;T===this.SET&&(Z[_]={})}Z=Z[_]}if(T===this.GET)return Z[X[Y]];return T===this.SET?(Z[X[Y]]=W,U):void 0},getByPath:function(T,U){return this.interact(this.GET,T,U)},setByPath:function(T,U,V){return this.interact(this.SET,T,U,V)},glance:function(T){for(var U,V=T.nodeName.toLowerCase(),W=0,X=T.attributes.length;W<X;W++)U=T.attributes[W],V=V+' '+U.name+'="'+U.value+'"';return V},eachElement:function(T,U,V,W,X){for(var Z,$,Y=0;Y<T.length;Y++)if(Z=T[Y],$=this.glance(Z),U&&U.test($))Y+=Z.children.length;else if(V&&V.test($))continue;else W&&W.test($)&&X(Z,Y)}},o=n;a.prototype.on=function(T){if('function'==typeof T.value){var U=this,V=T.cmds[1],W=T.opts[T.opts.length-1];U.element.removeEventListener(V,U.listeners[W],!1),U.listeners[W]=function(X){X.preventDefault(),T.value.call(U.controller.model,X)},U.element.addEventListener(V,U.listeners[W],!1)}},a.prototype.each=function(T){var U=this;U.clone||(U.clone=U.element.children[0]);var V=T.cmds.slice(1),W=U.clone.cloneNode(!0),X='';W=W.outerHTML,V=o.toCamelCase(V),V=new RegExp('="'+V,'g');for(var Y=0,Z=T.value.length;Y<Z;Y++)X+=W.replace(V,'="'+T.attribute.value+'.'+Y.toString());U.element.innerHTML=X,U.controller.insert(U.element.getElementsByTagName('*'))},a.prototype.value=function(T){var U=this;if(('checkbox'===U.element.type||'radio'===U.element.type)&&(T.value=U.modifiers(T.attribute.value,T.value),U.element.value=T.value,U.element.checked=T.value),!U.isChangeEventAdded){U.isChangeEventAdded=!0;var V=function(W){if(!U.isChanging){U.isChanging=!0;var X=W.target,Y='checkbox'===X.type||'radio'===X.type?X.checked:X.value,Z=X.getAttribute(U.controller.sValue);Y=U.modifiers(Z,Y),Z=Z.replace(U.controller.rPath,''),o.setByPath(U.controller.model,Z,Y),U.isChanging=!1}};U.element.addEventListener('change',V),U.element.addEventListener('keyup',V)}},a.prototype.html=function(T){this.element.innerHTML=T.value,this.controller.insert(this.element.getElementsByTagName('*'))},a.prototype.css=function(T){1<T.cmds.length&&(T.value=T.cmds.slice(1).join('-')+': '+T.value+';'),this.element.style.cssText+=T.value},a.prototype.class=function(T){var U=T.cmds.slice(1).join('-');this.element.classList.toggle(U,T.value)},a.prototype.enable=function(T){this.element.disabled=!T.value},a.prototype.disable=function(T){this.element.disabled=T.value},a.prototype.show=function(T){this.element.hidden=!T.value},a.prototype.hide=function(T){this.element.hidden=T.value},a.prototype.write=function(T){this.element.readOnly=!T.value},a.prototype.read=function(T){this.element.readOnly=T.value},a.prototype.selected=function(T){this.element.selectedIndex=T.value},a.prototype.text=function(T){this.element.innerText=T.value},a.prototype.default=function(T){var U=o.toCamelCase(T.cmds);o.setByPath(this.element,U,T.value)},a.prototype.modifiers=function(T,U){if(-1===T.indexOf('|'))return U;for(var V=this,W=T.replace(V.controller.rModifier,'').split(' '),X=0,Y=W.length;X<Y;X++)W[X]in V.controller.modifiers&&(U=V.controller.modifiers[W[X]].call(U));return U},a.prototype.render=function(T){var U=this,V={attribute:T};V.attribute.value=V.attribute.value.trim(),V.path=V.attribute.value.replace(U.controller.rPath,''),V.command=V.attribute.name.replace(U.controller.rPrefix,''),V.opts=V.path.split('.'),V.cmds=V.command.split('-'),V.value=o.getByPath(U.controller.model,V.path),V.value=U.modifiers(V.attribute.value,V.value);null===V.value||void 0===V.value||(V.cmds[0]in U?U[V.cmds[0]](V):U.default(V))},a.prototype.eachAttribute=function(T,U){var V=this.element.attributes,W=0,X=V.length,Y;for('string'==typeof T&&(T=new RegExp(T)),W;W<X;W++)Y={name:V[W].name,value:V[W].value,full:V[W].name+'="'+V[W].value+'"'},T&&T.test(Y.full)&&U(Y,W)};b.prototype.descriptor=function(T,U,V){return{configurable:!0,enumerable:!0,get:function(){return U},set:function(W){U=W,V(T,U)}}},b.prototype.ins=function(T,U,V,W,X){('Object'===X.constructor.name||'Array'===X.constructor.name)&&(X=this.create(X,U,V+W,!0)),'Array'===T.constructor.name&&-1==W&&(W=0,T.splice(W,0,X),T=Object.defineProperty(T,W,this.descriptor(V+W,X,U)),W=T.length-1,X=T[W]),T=Object.defineProperty(T,W,this.descriptor(V+W,X,U)),U&&U(V+W,X)},b.prototype.del=function(T,U,V,W){if('Object'===T.constructor.name)delete T[W];else if('Array'===T.constructor.name){var X=T.length-1;T.splice(W,1),W=X}U&&U(V+W,void 0)},b.prototype.create=function(T,U,V,W){var X,Y,Z,$;for(Y in V?V+='.':V='',$=T.constructor.name,X='Object'===$?{}:[],X=Object.defineProperty(X,'ins',{value:this.ins.bind(this,X,U,V)}),X=Object.defineProperty(X,'del',{value:this.del.bind(this,X,U,V)}),T)Z=T[Y],$=Z.constructor.name,('Object'===$||'Array'===$)&&(Z=this.create(Z,U,V+Y)),X=Object.defineProperty(X,Y,this.descriptor(V+Y,Z,U)),W&&U&&U(V+Y,Z);return X};var t=function(T,U){return new b().create(T,U)};d.prototype.insert=function(T){var U=this;n.eachElement(T,U.rRejects,null,U.rAccepts,function(V,W){var X=new a(V,U);X.eachAttribute(U.rAccepts,function(Y){U.rFor.test(Y.name)&&++W,U.view[Y.value]?U.view[Y.value].push(X):U.view[Y.value]=[X],X.render(Y)})})},d.prototype.render=function(){var T=this;T.model=t(T.model,function(U){var V=U.split('.');1<V.length&&!isNaN(V.slice(-1))&&(U=V.slice(0,-1).join('.'));var W=T.view[U];if(W)for(var Z,X=0,Y=W.length;X<Y;X++)Z=W[X],Z.eachAttribute(T.sAccepts+U,function($){Z.render($)})}),T.insert(T.scope.getElementsByTagName('*'))};var w=function(T,U){var V=new d(T,U);return V.render(),V},x={html:'text/html',text:'text/plain',xml:'application/xml, text/xml',json:'application/json, text/javascript',urlencoded:'application/x-www-form-urlencoded',script:'text/javascript, application/javascript, application/x-javascript'},y={mime:x,fetch:function(T){if(!T)throw new Error('fetch: requires options');if(!T.action)throw new Error('fetch: requires options.action');if(T.method||(T.method='GET'),T.headers||(T.headers={}),T.data)if('GET'===T.method)T.action=T.action+'?'+f(T.data),T.data=null;else{switch(T.requestType=T.requestType?T.requestType.toLowerCase():'',T.responseType=T.responseType?T.responseType.toLowerCase():'',T.requestType){case'script':T.contentType=x.script;break;case'json':T.contentType=x.json;break;case'xml':T.contentType=x.xm;break;case'html':T.contentType=x.html;break;case'text':T.contentType=x.text;break;default:T.contentType=x.urlencoded;}switch(T.responseType){case'script':T.accept=x.script;break;case'json':T.accept=x.json;break;case'xml':T.accept=x.xml;break;case'html':T.accept=x.html;break;case'text':T.accept=x.text;}T.contentType===x.json&&(T.data=JSON.stringify(T.data)),T.contentType===x.urlencoded&&(T.data=f(T.data))}var U=new XMLHttpRequest;if(U.open(T.method.toUpperCase(),T.action,!0,T.username,T.password),T.mimeType&&U.overrideMimeType(T.mimeType),T.withCredentials&&(U.withCredentials=T.withCredentials),T.accept&&(T.headers.Accept=T.accept),T.contentType&&(T.headers['Content-Type']=T.contentType),T.headers)for(var V in T.headers)U.setRequestHeader(V,T.headers[V]);U.onreadystatechange=function(){if(4===U.readyState)return 200<=U.status&&400>U.status?T.success(U):T.error(U)},U.send(T.data)},serialize:f},z='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split(''),C=y,D=function(){var U=[],V;U[8]=U[13]=U[18]=U[23]='-',U[14]='4';for(var W=0;36>W;W++)U[W]||(V=0|16*Math.random(),U[W]=z[19==W?8|3&V:V]);return U.join('')},E=/^http|^\/|^\.\//i,F=/<|>/i,K={has:function(T,U){return-1!==T.indexOf(U)}};document.createElement('style').appendChild(document.createTextNode('')),document.registerElement('j-view',{prototype:Object.create(HTMLElement.prototype)});return{register:function(T){if(!T)throw new Error('Component: missing options');if(!T.name)throw new Error('Component: missing name');var U={},V=!1;U.services=this.services,U.proto=Object.create(HTMLElement.prototype),U.name=T.name,U.model=T.model,U.extends=T.extends,U.template=T.template,U.controller=T.controller,U.template&&('Function'===U.template.constructor.name?U.template=m(U.template):'String'===U.template.constructor.name?E.test(U.template)?V=!0:F.test(U.template)?U.template=m(U.template):U.template=document.currentScript?document.currentScript.ownerDocument.querySelector(U.template):document._currentScript.ownerDocument.querySelector(U.template):U.template=T.template),U.proto.attachedCallback=T.attached?T.attached.bind(U):null,U.proto.detachedCallback=T.detached?T.detached.bind(U):null,U.proto.attributeChangedCallback=T.attributed?T.attributed.bind(U):null,U.proto.createdCallback=function(){function W(){U.uuid=D(),U.element.appendChild(document.importNode(U.template.content,!0)),U.binder=w({name:U.uuid,scope:U.element,model:U.model},U.controller),T.created&&T.created.call(U)}U.element=this,V?h(U.template,function(X){U.template=m(X),W()}):W()},document.registerElement(U.name,{prototype:U.proto,extends:U.extends})},router:{render:function(T){var U=this,V=null;T.title&&(document.title=T.title),'string'==typeof T.component?(V=U.components[T.component],!V&&(V=U.components[T.component]=document.createElement(T.component))):V=T.component,U.view.firstChild&&U.view.removeChild(U.view.firstChild),U.view.appendChild(V),window.scroll(0,0)},path:{normalize:function(T){return T=decodeURI(T).replace(/\/{2,}/g,'/').replace(/\?.*/,'').replace(/\/$/,''),''===T?'/':T},getHash:function(T){return this.normalize(T.split('?')[0].split('#')[1]||'')},getSearch:function(T){return this.normalize(T.split('?')[1]||'')},getPath:function(T,U,V){return this.normalize(T.replace(window.location.origin,'/').replace(U,'/').replace(V,'/'))}},setup:function(T){function U(){V.view=document.querySelector('j-view')||document.querySelector('[j-view]'),V.navigate({path:window.location.href},!0)}var V=this;return V.components={},V.routes=T.routes||[],V.redirects=T.redirects||[],V.mode=T.mode,V.mode=null===V.mode||void 0===V.mode||V.mode,V.mode='history'in window&&'pushState'in window.history&&V.mode,V.ready=0,V.isChangeEvent=!0,V.base=T.base||'',V.external=T.external||'',V.root=T.root||(V.mode?'/':'/#'),V.state={root:V.root,base:V.base,origin:V.path.normalize(V.base+V.root)},window.addEventListener('DOMContentLoaded',function(){V.ready++,2===V.ready&&U()},!1),window.addEventListener('WebComponentsReady',function(){V.ready++,2===V.ready&&U()},!1),window.addEventListener(V.mode?'popstate':'hashchange',function(W){if(V.isChangeEvent){var X=V.mode?W.state:{path:W.newURL};V.navigate(X,!0)}else V.isChangeEvent=!0},!1),window.addEventListener('click',function(W){if(!(W.metaKey||W.ctrlKey||W.shiftKey)){for(var X=W.path?W.path[0]:W.target;X&&'A'!==X.nodeName;)X=X.parentNode;!X||'A'!==X.nodeName||V.external&&0!==V.path.path(X.href,V.state.base,V.state.root).indexOf(V.external)||X.hasAttribute('download')||'external'===X.getAttribute('rel')||K.has(X.href,'mailto:')||K.has(X.href,'tel:')||K.has(X.href,'file:')||K.has(X.href,'ftp:')||(W.preventDefault(),V.navigate({path:X.href}))}},!1),V},redirect:function(T){var U=this;return window.location=T.path,U},add:function(T){var U=this;return'Object'===T.constructor.name?U.routes.push(T):'Array'===T.constructor.name&&(U.routes=U.routes.concat(T)),U},remove:function(T){for(var X,U=this,V=0,W=U.routes.length;V<W;V++)if(X=U.routes[V],T===X.path){U.routes.splice(V,1);break}return U},get:function(T){var U=this,V=0,W=null,X=U.routes.length;for(V;V<X;V++)if(W=U.routes[V],!W.path)throw new Error('Router: missing path option');else if('string'==typeof W.path){if(W.path===T||W.path==='/'+T)return W;}else if('function'==typeof W.path&&W.path.test(T))return W;return W={},W.title='404',W.component=document.createElement('div'),W.component.innerHTML='{ "statusCode": 404, "error": "Not Found" }',W},change:function(T,U){var V=this;return V.mode?window.history[U?'replaceState':'pushState'](T,T.title,T.origin+T.path):(V.isChangeEvent=!1,window.location=T.origin+T.path),V},navigate:function(T,U){var V=this;return V.state.path=V.path.getPath(T.path,V.state.base,V.state.root),V.state.hash=V.path.getHash(V.state.path),V.state.search=V.path.getSearch(V.state.path),V.state.href=V.path.normalize(window.location.href),V.route=V.get(V.state.path),V.state.title=V.route.title,console.log(V.state),V.change(V.state,U),V.route.redirect?V.redirect(V.route):V.render(V.route),V}},binder:w,http:y,services:{},query:function(T){return document.currentScript?document.currentScript.ownerDocument.querySelector(T):document._currentScript.ownerDocument.querySelector(T)},script:function(){return document.currentScript?document.currentScript:document._currentScript},document:function(){return document.currentScript?document.currentScript.ownerDocument:document._currentScript.ownerDocument}}});